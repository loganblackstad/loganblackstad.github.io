---
title: "Analyzing Rap Lyrics Using Word Vectors"
author_profile: false
author: Tim Dobbins
excerpt: In this post, we'll analyze lyrics from the best rappers of all time.
categories: [2018, january]
tags: [python, machine-learning, data-science]
---
<link rel="stylesheet" type="text/css" href="/assets/css/ipython.css">
<style>
    table.dataframe {
       white-space:nowrap;
    }
    div.output_subarea {
       max-height: 400px;
    }
    div.input_area {
       margin: 5px;
    }
</style>
<div class="cell text_cell rendered " tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.5903px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 111px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In this post, we'll analyze lyrics from the best rappers of all time. To do this, we'll use Python and <span class="cm-link">[gensim's]</span><span class="cm-string cm-url">(https://radimrehurek.com/gensim/)</span> implementation of the <span class="cm-link">[Doc2Vec]</span><span class="cm-string cm-url">(https://arxiv.org/abs/1405.4053)</span> algorithm. To get the data, we'll use <span class="cm-link">[Cypher]</span><span class="cm-string cm-url">(https://github.com/tmthyjames/cypher)</span>, a new Python package <span class="cm-link">[I recently released]</span><span class="cm-string cm-url">(https://tmthyjames.github.io/tools/Cypher/)</span> that retrieves music lyrics.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 141px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>In this post, we'll analyze lyrics from the best rappers of all time. To do this, we'll use Python and <a href="https://radimrehurek.com/gensim/" target="_blank">gensim's</a> implementation of the <a href="https://arxiv.org/abs/1405.4053" target="_blank">Doc2Vec</a> algorithm. To get the data, we'll use <a href="https://github.com/tmthyjames/cypher" target="_blank">Cypher</a>, a new Python package <a href="https://tmthyjames.github.io/tools/Cypher/" target="_blank">I recently released</a> that retrieves music lyrics.</p>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59027px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 200px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code" style="">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Contents</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Quick Note On Doc2Vec]</span><span class="cm-string cm-url">(#Quick-Note-on-Doc2Vec)</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Getting the Data]</span><span class="cm-string cm-url">(#Getting-the-Data)</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Loading the Data]</span><span class="cm-string cm-url">(#Loading-the-Data)</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Initializing the Model]</span><span class="cm-string cm-url">(#Initializing-the-Model)</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Training the Model]</span><span class="cm-string cm-url">(#Training-the-Model)</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Finding Most Similar Words]</span><span class="cm-string cm-url">(#Finding-Most-Similar-Words)</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Finding Most Similar Documents]</span><span class="cm-string cm-url">(#Finding-Most-Similar-Documents)</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Inferring Vectors]</span><span class="cm-string cm-url">(#Inferring-Vectors)</span><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Up Next]</span><span class="cm-string cm-url">(#Up-Next)</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 230px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Contents">Contents<a class="anchor-link" href="#Contents">¶</a></h2>
            <p>• <a href="#Quick-Note-on-Doc2Vec">Quick Note On Doc2Vec</a><br>
                • <a href="#Getting-the-Data">Getting the Data</a><br>
                • <a href="#Loading-the-Data">Loading the Data</a><br>
                • <a href="#Initializing-the-Model">Initializing the Model</a><br>
                • <a href="#Training-the-Model">Training the Model</a><br>
                • <a href="#Finding-Most-Similar-Words">Finding Most Similar Words</a><br>
                • <a href="#Finding-Most-Similar-Documents">Finding Most Similar Documents</a><br>
                • <a href="#Inferring-Vectors">Inferring Vectors</a><br>
                • <a href="#Up-Next">Up Next</a>
            </p>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59027px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Quick Note on Doc2Vec</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Quick-Note-on-Doc2Vec">Quick Note on Doc2Vec<a class="anchor-link" href="#Quick-Note-on-Doc2Vec">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59027px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 211px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Doc2Vec is an extension of Word2Vec, an algorithm that employs a shallow neural network to map words to a vector space called word vectors (or word embeddings). Whereas Word2Vec produces word vectors so you can run similarity queries between <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">i</span><span class="cm-tag cm-bracket">&gt;</span>words<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">i</span><span class="cm-tag cm-bracket">&gt;</span>, Doc2Vec produces document vectors so you can run similarity queries on whole sentences, paragraphs, or documents. Finding semantic similarities is based on the distributional hypothesis that states words that appear in the same contexts share the same meaning. Or, as the English linguist J. R. Firth put it, "a word is characterized by the company it keeps".</span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">My aim for this post isn't to cover the theory or math behind Doc2Vec but to show its power. For a deeper overview of Doc2Vec, see <span class="cm-link">[here]</span><span class="cm-string cm-url">(https://medium.com/scaleabout/a-gentle-introduction-to-doc2vec-db3e8c0cce5e)</span>.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 241px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Doc2Vec is an extension of Word2Vec, an algorithm that employs a shallow neural network to map words to a vector space called word vectors (or word embeddings). Whereas Word2Vec produces word vectors so you can run similarity queries between <i>words</i>, Doc2Vec produces document vectors so you can run similarity queries on whole sentences, paragraphs, or documents. Finding semantic similarities is based on the distributional hypothesis that states words that appear in the same contexts share the same meaning. Or, as the English linguist J. R. Firth put it, "a word is characterized by the company it keeps".</p>
            <p>My aim for this post isn't to cover the theory or math behind Doc2Vec but to show its power. For a deeper overview of Doc2Vec, see <a href="https://medium.com/scaleabout/a-gentle-introduction-to-doc2vec-db3e8c0cce5e" target="_blank">here</a>.</p>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59027px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Getting the Data</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Getting-the-Data">Getting the Data<a class="anchor-link" href="#Getting-the-Data">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 161px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To get all the lyrics for the top 100 rappers, we'll use <span class="cm-link">[Cypher]</span><span class="cm-string cm-url">(https://github.com/tmthyjames/cypher)</span>, a new python library <span class="cm-link">[I released]</span><span class="cm-string cm-url">(https://tmthyjames.github.io/tools/Cypher/)</span> recently to retrieve music lyrics (to install: <span class="cm-comment">`pip install thecypher`</span>). But first, we need to get a list of the top 100 rappers. For this, I just Googled "top rappers" and got a hit from <span class="cm-link">[ranker.com]</span><span class="cm-string cm-url">(https://www.ranker.com/crowdranked-list/the-greatest-rappers-of-all-time)</span>. This will suffice, although I don't think this list is perfect. Luckily they source the data from an API so we don't have to screen scrape! Here's the code to get this list:</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 191px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>To get all the lyrics for the top 100 rappers, we'll use <a href="https://github.com/tmthyjames/cypher" target="_blank">Cypher</a>, a new python library <a href="https://tmthyjames.github.io/tools/Cypher/" target="_blank">I released</a> recently to retrieve music lyrics (to install: <code>pip install thecypher</code>). But first, we need to get a list of the top 100 rappers. For this, I just Googled "top rappers" and got a hit from <a href="https://www.ranker.com/crowdranked-list/the-greatest-rappers-of-all-time" target="_blank">ranker.com</a>. This will suffice, although I don't think this list is perfect. Luckily they source the data from an API so we don't have to screen scrape! Here's the code to get this list:</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[1]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 541.802px; margin-bottom: 0px; border-right-width: 30px; min-height: 175px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">import</span> <span class="cm-variable">requests</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">url</span> = <span class="cm-string">'https://cache-api.ranker.com/lists/855723/items'</span><span class="cm-error">\</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-string">'?limit=100&amp;offset=0&amp;include=votes,wikiText,rankings,'</span><span class="cm-error">\</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">      <span class="cm-string">'openListItemContributors&amp;propertyFetchType=ALL&amp;liCacheKey=null'</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">r</span> = <span class="cm-variable">requests</span>.<span class="cm-property">get</span>(<span class="cm-variable">url</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">data</span> = <span class="cm-variable">r</span>.<span class="cm-property">json</span>()</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">artists</span> = [<span class="cm-variable">i</span>[<span class="cm-string">'name'</span>] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">data</span>[<span class="cm-string">'listItems'</span>]]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">artists</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 205px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt"></div>
                <div class="output_subarea output_text output_stream output_stdout">
                    <pre>['Tupac', 'Eminem', 'The Notorious B.I.G.', 'Nas', 'Ice Cube', 'Jay-Z', 'Snoop Dogg', 'Dr. Dre', 'Kendrick Lamar', 'Rakim', 'André 3000', 'Eazy-E', 'Kanye West', '50 Cent', 'DMX', 'Busta Rhymes', 'Method Man', 'J. Cole', 'Mos Def', 'Ludacris', 'KRS-One', 'LL Cool J', 'Lil Wayne', 'Common', 'Big L', 'Ghostface Killah', 'Redman', 'T.I.', 'Big Pun', 'Nate Dogg', 'Tech N9ne', 'Lauryn Hill', 'Scarface', 'Slick Rick', 'Raekwon', 'Big Daddy Kane', "Ol' Dirty Bastard", 'The Game', 'Mobb Deep', 'Logic', 'Chance the Rapper', 'Cypress Hill', 'Ice-T', 'Lupe Fiasco', 'RZA', 'GZA', 'Q-Tip', 'Warren G', 'Talib Kweli', 'Xzibit', 'Missy Elliott', 'ASAP Rocky', 'Joey Badass', 'Immortal Technique', 'Twista', 'Big Sean', 'Kid Cudi', 'Big Boi', 'Chuck D', 'Donald Glover', 'Drake', 'Wiz Khalifa', 'Eric B. &amp; Rakim', 'Schoolboy Q', 'DMC', 'Nelly', 'Hopsin', 'D12', 'Jadakiss', 'Tyler, the Creator', 'Kurupt', 'Grandmaster Flash and the Furious Five', 'Gang Starr', 'Too $hort', 'Royce da 5&amp;#39;9&amp;#34;', 'MC Ren', 'E-40', 'Pusha T', 'Coolio', 'De La Soul', 'Proof', 'Bad Meets Evil', 'Guru', 'Will Smith', 'Krayzie Bone', 'Black Thought', 'B.o.B', 'AZ', 'Yelawolf', 'The Sugarhill Gang', 'Earl Sweatshirt', 'Fabolous', 'Mac Miller', 'Fat Joe', 'Young Jeezy', 'Kool G Rap', 'Bizzy Bone', 'Queen Latifah', 'Prodigy', '2 Chainz']
</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 61px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To use Cypher to retrieve these lyrics we'll loop over the list and run <span class="cm-comment">`thecypher.get_lyrics`</span> on each artist. The following will <span class="cm-comment">`get_lyrics`</span> and then convert it to a <span class="cm-comment">`DataFrame`</span>.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 91px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>To use Cypher to retrieve these lyrics we'll loop over the list and run <code>thecypher.get_lyrics</code> on each artist. The following will <code>get_lyrics</code> and then convert it to a <code>DataFrame</code>.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[2]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 372.41px; margin-bottom: 0px; border-right-width: 30px; min-height: 256px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">import</span> <span class="cm-variable">thecypher</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lyrics</span> = []</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">artist</span> <span class="cm-keyword">in</span> <span class="cm-variable">artists</span>:</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># our Cypher code</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">artist_lyrics</span> = <span class="cm-variable">thecypher</span>.<span class="cm-property">get_lyrics</span>(<span class="cm-variable">artist</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment"># append each record</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    [<span class="cm-variable">lyrics</span>.<span class="cm-property">append</span>(<span class="cm-variable">i</span>) <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">artist_lyrics</span>]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># convert to a DataFrame</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lyrics_df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>(<span class="cm-variable">lyrics</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lyrics_df</span>.<span class="cm-property">head</span>()</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 286px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[2]:</div>
                <div class="output_subarea output_html rendered_html output_result">
                    <div>
                        <table border="1" class="dataframe">
                            <thead>
                                <tr style="text-align: right">
                                    <th></th>
                                    <th>album</th>
                                    <th>artist</th>
                                    <th>genre</th>
                                    <th>id</th>
                                    <th>lyric</th>
                                    <th>song</th>
                                    <th>year</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th>0</th>
                                    <td>Infinite (1996)</td>
                                    <td>Eminem</td>
                                    <td>Hip_Hop</td>
                                    <td>14201</td>
                                    <td>Oh yeah, this is Eminem baby, back up in that motherfucking ass</td>
                                    <td>Infinite</td>
                                    <td>1996</td>
                                </tr>
                                <tr>
                                    <th>1</th>
                                    <td>Infinite (1996)</td>
                                    <td>Eminem</td>
                                    <td>Hip_Hop</td>
                                    <td>14202</td>
                                    <td>One time for your mother fucking mind, we represent the 313</td>
                                    <td>Infinite</td>
                                    <td>1996</td>
                                </tr>
                                <tr>
                                    <th>2</th>
                                    <td>Infinite (1996)</td>
                                    <td>Eminem</td>
                                    <td>Hip_Hop</td>
                                    <td>14203</td>
                                    <td>You know what I'm saying?, 'cause they don't know shit about this</td>
                                    <td>Infinite</td>
                                    <td>1996</td>
                                </tr>
                                <tr>
                                    <th>3</th>
                                    <td>Infinite (1996)</td>
                                    <td>Eminem</td>
                                    <td>Hip_Hop</td>
                                    <td>14204</td>
                                    <td>For the 9-6</td>
                                    <td>Infinite</td>
                                    <td>1996</td>
                                </tr>
                                <tr>
                                    <th>4</th>
                                    <td>Infinite (1996)</td>
                                    <td>Eminem</td>
                                    <td>Hip_Hop</td>
                                    <td>14205</td>
                                    <td>Ayo, my pen and paper cause a chain reaction</td>
                                    <td>Infinite</td>
                                    <td>1996</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 44px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">By default, the data is delivered with one lyric per row. The following code will convert it to one song per row:</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 74px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>By default, the data is delivered with one lyric per row. The following code will convert it to one song per row:</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[3]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 403.139px; margin-bottom: 0px; border-right-width: 30px; min-height: 125px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">group</span> = [<span class="cm-string">'song'</span>, <span class="cm-string">'year'</span>, <span class="cm-string">'album'</span>, <span class="cm-string">'genre'</span>, <span class="cm-string">'artist'</span>]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lyrics_by_song</span> = <span class="cm-variable">lyrics_df</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">group</span>)<span class="cm-error">\</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">       .<span class="cm-property">groupby</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">group</span>).<span class="cm-property">lyric</span><span class="cm-error">\</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">       .<span class="cm-property">apply</span>(<span class="cm-string">' '</span>.<span class="cm-property">join</span>)<span class="cm-error">\</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">       <span class="cm-null cm-error">.</span><span class="cm-property">reset_index</span>(<span class="cm-variable">name</span>=<span class="cm-string">'lyric'</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lyrics_by_song</span>.<span class="cm-property">head</span>(<span class="cm-number">1</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 155px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to scroll output; double click to hide" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[3]:</div>
                <div class="output_subarea output_html rendered_html output_result">
                    <div>
                        <table border="1" class="dataframe">
                            <thead>
                                <tr style="text-align: right">
                                    <th></th>
                                    <th>song</th>
                                    <th>year</th>
                                    <th>album</th>
                                    <th>genre</th>
                                    <th>artist</th>
                                    <th>lyric</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th>0</th>
                                    <td>313</td>
                                    <td>1996</td>
                                    <td>Infinite (1996)</td>
                                    <td>Hip_Hop</td>
                                    <td>Eminem</td>
                                    <td>Eye-Kyu: Now what you know about a sweet MC, from the 313 None of these skills you bout to see come free So you wanna be a sweet MC, you gotta become me If you ever wanna be one see Eminem: Man what you know about a sweet MC, in the 313 None of these skills you bout to see come free So you wanna be a sweet MC, you better become me If you ever wanna be one see Verse 1: Eye-Kyu Yo some people say I'm whack, now if that's right I'm the freshest whack MC that you ever heard, in your lifetime My slick accapella sounds clever with the beats Boy I'm the deepest thing since potholes to ever hit the streets Forgot a gold digger's succubus, my souls thick with ruggedness With the mic....</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 61px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">You can find the data <span class="cm-link">[here]</span><span class="cm-string cm-url">(https://github.com/tmthyjames/cypher/tree/master/data)</span>, randomly split into training and testing sets.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 91px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>You can find the data <a href="https://github.com/tmthyjames/cypher/tree/master/data" target="_blank">here</a>, randomly split into training and testing sets.</p>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Loading the Data</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Loading-the-Data">Loading the Data<a class="anchor-link" href="#Loading-the-Data">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 94px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Next, we need to load the data. Doc2Vec requires A LOT of memory, so we'll create an iterator so our data doesn't have to be loaded into memory simultaneously. Instead, we load one document at a time, train the model on it, then discard it and move on to the next document. We could also stream this data from a database if we wanted. Here's how you stream the data from a file:</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 124px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Next, we need to load the data. Doc2Vec requires A LOT of memory, so we'll create an iterator so our data doesn't have to be loaded into memory simultaneously. Instead, we load one document at a time, train the model on it, then discard it and move on to the next document. We could also stream this data from a database if we wanted. Here's how you stream the data from a file:</p>
        </div>
    </div>
</div>
<div class="cell code_cell rendered un" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[4]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 487.545px; margin-bottom: 0px; border-right-width: 30px; min-height: 387px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors" style=""></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">import</span> <span class="cm-variable">csv</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">nltk</span>.<span class="cm-property">stem</span> <span class="cm-keyword cm-cm-overlay cm-matchhighlight">import</span> <span class="cm-variable">WordNetLemmatizer</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">gensim</span>.<span class="cm-property">models</span>.<span class="cm-property">doc2vec</span> <span class="cm-keyword cm-cm-overlay cm-matchhighlight">import</span> <span class="cm-variable">TaggedDocument</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">wnl</span> = <span class="cm-variable">WordNetLemmatizer</span>()</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">Sentences</span>(<span class="cm-builtin">object</span>):</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">filename</span>, <span class="cm-variable">column</span>):</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable-2">self</span>.<span class="cm-property">filename</span> = <span class="cm-variable">filename</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable-2">self</span>.<span class="cm-property">column</span> = <span class="cm-variable">column</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-meta">@staticmethod</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">def</span> <span class="cm-def">get_tokens</span>(<span class="cm-variable">text</span>):</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"""Helper function for tokenizing data"""</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">return</span> [<span class="cm-variable">wnl</span>.<span class="cm-property">lemmatize</span>(<span class="cm-variable">r</span>.<span class="cm-property">lower</span>()) <span class="cm-keyword">for</span> <span class="cm-variable">r</span> <span class="cm-keyword">in</span> <span class="cm-variable">text</span>.<span class="cm-property">split</span>()]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-null cm-error">    </span><span class="cm-keyword">def</span> <span class="cm-def">__iter__</span>(<span class="cm-variable-2">self</span>):</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">reader</span> = <span class="cm-variable">csv</span>.<span class="cm-property">DictReader</span>(<span class="cm-builtin">open</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">filename</span>, <span class="cm-string">'r'</span> ))</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">for</span> <span class="cm-variable">row</span> <span class="cm-keyword">in</span> <span class="cm-variable">reader</span>:</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">words</span> = <span class="cm-variable-2">self</span>.<span class="cm-property">get_tokens</span>(<span class="cm-variable">row</span>[<span class="cm-variable-2">self</span>.<span class="cm-property">column</span>])</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">tags</span> = [<span class="cm-string">'%s|%s'</span> <span class="cm-operator">%</span> (<span class="cm-variable">row</span>[<span class="cm-string">'artist'</span>], <span class="cm-variable">row</span>[<span class="cm-string">'song_id'</span>])]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-keyword">yield</span> <span class="cm-variable">TaggedDocument</span>(<span class="cm-variable">words</span>=<span class="cm-variable">words</span>, <span class="cm-variable">tags</span>=<span class="cm-variable">tags</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 417px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div>
        <div class="output" style="display: none;"></div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 144px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">A couple things to note. First, the Doc2Vec model accepts a list of <span class="cm-comment">`TaggedDocument`</span> elements which will allow us to identify a song. Second, we use <span class="cm-comment">`wnl.lemmatize`</span> as apart of our tokenization so we can group together the inflected forms of a word so they can be analysed as a single word. For instance, <span class="cm-comment">`wnl.lemmatize`</span> will convert 'cars' into 'car'.</span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To initialize our Sentence object, we do the following:</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 174px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>A couple things to note. First, the Doc2Vec model accepts a list of <code>TaggedDocument</code> elements which will allow us to identify a song. Second, we use <code>wnl.lemmatize</code> as apart of our tokenization so we can group together the inflected forms of a word so they can be analysed as a single word. For instance, <code>wnl.lemmatize</code> will convert 'cars' into 'car'.</p>
            <p>To initialize our Sentence object, we do the following:</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[5]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59619px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 426.264px; margin-bottom: 0px; border-right-width: 30px; min-height: 93px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">filename</span> = <span class="cm-string">'lyrics_train.csv'</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">sentences</span> = <span class="cm-variable">Sentences</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">filename</span>=<span class="cm-variable cm-cm-overlay cm-matchhighlight">filename</span>, <span class="cm-variable">column</span>=<span class="cm-string">'word'</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># for song lookups</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">df_train</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">filename</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 123px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div>
        <div class="output" style="display: none;"></div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Initializing the Model</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Initializing-the-Model">Initializing the Model<a class="anchor-link" href="#Initializing-the-Model">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 28px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To initialize our <span class="cm-comment">`Doc2Vec`</span> model, we'll do the following:</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 58px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>To initialize our <code>Doc2Vec</code> model, we'll do the following:</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[6]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59619px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 318.521px; margin-bottom: 0px; border-right-width: 30px; min-height: 224px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">from</span> <span class="cm-variable">gensim</span>.<span class="cm-property">models</span>.<span class="cm-property">doc2vec</span> <span class="cm-keyword">import</span> <span class="cm-variable">Doc2Vec</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">model</span> = <span class="cm-variable">Doc2Vec</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">alpha</span>=<span class="cm-number">0.025</span>,</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">min_alpha</span>=<span class="cm-number">0.025</span>,</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">workers</span>=<span class="cm-number">15</span>, </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">min_count</span>=<span class="cm-number">2</span>,</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">window</span>=<span class="cm-number">10</span>,</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">size</span>=<span class="cm-number">300</span>,</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">iter</span>=<span class="cm-number">20</span>,</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">sample</span>=<span class="cm-number">0.001</span>,</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">negative</span>=<span class="cm-number">5</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 254px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div>
        <div class="output" style="display: none;"></div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 361px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code" style="">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's go over each argument.</span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`alpha`</span> is the initial learning rate. A very intuitive explanation for learning rate can be found <span class="cm-link">[here]</span><span class="cm-string cm-url">(https://www.quora.com/What-is-the-learning-rate-in-neural-networks)</span>. Essentially, the learning rate is, as stated in the link, "how quickly a network abandons old beliefs for new ones." <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`min_alpha`</span> is exactly what it sounds like, the minimum <span class="cm-comment">`alpha`</span> can be, which we reduce after every epoch. <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`workers`</span> is the number of threads used to train the model. <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`min_count`</span> specifies a term frequency that must be met for a word to be considered by the model. <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`window`</span> is how many words in front and behind the input word should be considered when determining context. <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`size`</span> is the number of dimensions. Unlike most numerical datasets that have 2 dimensions, text data can have hundreds or even more.<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`iter`</span> is the number of iterations, the number of times the training set passes through the algorithm. <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`sample`</span> is the downsampling rate. Words representing more than this will be eligible for downsampling.<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-comment">`negative`</span> is the negative sampling rate. 0 means update all weights in the output layer of the neural network.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 391px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Let's go over each argument.</p>
            <p>• <code>alpha</code> is the initial learning rate. A very intuitive explanation for learning rate can be found <a href="https://www.quora.com/What-is-the-learning-rate-in-neural-networks" target="_blank">here</a>. Essentially, the learning rate is, as stated in the link, "how quickly a network abandons old beliefs for new ones." <br>
                • <code>min_alpha</code> is exactly what it sounds like, the minimum <code>alpha</code> can be, which we reduce after every epoch. <br>
                • <code>workers</code> is the number of threads used to train the model. <br>
                • <code>min_count</code> specifies a term frequency that must be met for a word to be considered by the model. <br>
                • <code>window</code> is how many words in front and behind the input word should be considered when determining context. <br>
                • <code>size</code> is the number of dimensions. Unlike most numerical datasets that have 2 dimensions, text data can have hundreds or even more.<br>
                • <code>iter</code> is the number of iterations, the number of times the training set passes through the algorithm. <br>
                • <code>sample</code> is the downsampling rate. Words representing more than this will be eligible for downsampling.<br>
                • <code>negative</code> is the negative sampling rate. 0 means update all weights in the output layer of the neural network.
            </p>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Training the Model</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Training-the-Model">Training the Model<a class="anchor-link" href="#Training-the-Model">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 411px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code" style="">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now we'll build our vocabulary and train our model. We'll train our model for 10 epochs. To understand epochs and how they differ from iterations (from above), check out <span class="cm-link">[this]</span><span class="cm-string cm-url">(https://stackoverflow.com/questions/4752626/epoch-vs-iteration-when-training-neural-networks)</span> StackOverflow post. Namely this answer:</span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-quote cm-quote-1">&gt; In the neural network terminology:</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-quote cm-quote-1">&gt; one epoch = one forward pass and one backward pass of all the training examples</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-quote cm-quote-1">&gt; batch size = the number of training examples in one forward/backward pass. The higher the batch size, the more memory space you'll need.</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-quote cm-quote-1">&gt; number of iterations = number of passes, each pass using [batch size] number of examples. To be clear, one pass = one forward pass + one backward pass (we do not count the forward pass and backward pass as two different passes).</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We use multiple epochs because neural networks typically require an iterative optimization method to produce good results, which usually means several passes over the data.</span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">After each epoch, we'll decrease the learning rate (known as learning rate decay). This is to help speed up our training. For more on learning rate decay and the intuition behind it, see Andrew Ng's <span class="cm-link">[video]</span><span class="cm-string cm-url">(https://www.coursera.org/learn/deep-neural-network/lecture/hjgIA/learning-rate-decay)</span> on the subject.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 441px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Now we'll build our vocabulary and train our model. We'll train our model for 10 epochs. To understand epochs and how they differ from iterations (from above), check out <a href="https://stackoverflow.com/questions/4752626/epoch-vs-iteration-when-training-neural-networks" target="_blank">this</a> StackOverflow post. Namely this answer:</p>
            <blockquote>
                <p>In the neural network terminology:</p>
                <p>one epoch = one forward pass and one backward pass of all the training examples</p>
                <p>batch size = the number of training examples in one forward/backward pass. The higher the batch size, the more memory space you'll need.</p>
                <p>number of iterations = number of passes, each pass using [batch size] number of examples. To be clear, one pass = one forward pass + one backward pass (we do not count the forward pass and backward pass as two different passes).</p>
            </blockquote>
            <p>We use multiple epochs because neural networks typically require an iterative optimization method to produce good results, which usually means several passes over the data.</p>
            <p>After each epoch, we'll decrease the learning rate (known as learning rate decay). This is to help speed up our training. For more on learning rate decay and the intuition behind it, see Andrew Ng's <a href="https://www.coursera.org/learn/deep-neural-network/lecture/hjgIA/learning-rate-decay" target="_blank">video</a> on the subject.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[7]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 618.625px; margin-bottom: 0px; border-right-width: 30px; min-height: 109px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">build_vocab</span>(<span class="cm-variable">sentences</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">epochs</span> = <span class="cm-number">10</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">epoch</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">epochs</span>):</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">train</span>(<span class="cm-variable">sentences</span>, <span class="cm-variable">total_examples</span>=<span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">corpus_count</span>, <span class="cm-variable">epochs</span>=<span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">iter</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">alpha</span> -= <span class="cm-number">0.002</span>  <span class="cm-comment"># decrease the learning rate</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">min_alpha</span> = <span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">alpha</span>  <span class="cm-comment"># fix the learning rate, no decay</span></span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 139px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div>
        <div class="output" style="display: none;"></div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 44px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To persist our model so we can use it later without training it again, we'll use <span class="cm-comment">`model.save`</span> and load it using <span class="cm-comment">`Doc2Vec.load`</span> like so:</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 74px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>To persist our model so we can use it later without training it again, we'll use <code>model.save</code> and load it using <code>Doc2Vec.load</code> like so:</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[8]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59644px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 326.229px; margin-bottom: 0px; border-right-width: 30px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">save</span>(<span class="cm-string">'rap-lyrics.doc2vec'</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span> = <span class="cm-variable">Doc2Vec</span>.<span class="cm-property">load</span>(<span class="cm-string">'rap-lyrics.doc2vec'</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 90px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div>
        <div class="output" style="display: none;"></div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 61px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Next we'll find the most similar words given a target word. Similar words, in this context, refers to words that have similar vector representations. Let's first see what one of these vector representations looks like:</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 91px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Next we'll find the most similar words given a target word. Similar words, in this context, refers to words that have similar vector representations. Let's first see what one of these vector representations looks like:</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[9]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 187.653px; margin-bottom: 0px; border-right-width: 30px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">wv</span>.<span class="cm-property">word_vec</span>(<span class="cm-string">'rap'</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 57px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to unscroll output; double click to hide" style=""></div>
        <div class="output " style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[9]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>array([ 0.08730847, -0.75961363,  1.38362062, -0.6143629 ,  0.38046223,
       -0.27822378,  1.0065887 ,  0.66717136,  0.53995496, -0.23645727,
       -0.54589874,  0.0852062 , -1.74815035,  0.11079719, -0.08960737,
        0.529109  , -0.50958592, -0.17503066, -0.79260975,  0.14438754,
        0.77649647, -0.45132214,  0.26107937, -0.94072151,  0.33201343,
        0.06891677,  0.07961012,  0.4604567 ,  0.59327006, -0.97538424,
        0.72243172, -0.62705523, -0.67403787, -0.49406284, -0.12099945,
        0.94990158, -0.13507502, -0.28207451,  0.26398847, -1.06900597,
       -0.00755116,  0.57757616,  1.11100399, -1.2982794 , -0.49452487,
       -0.87145579,  0.95555776, -0.11877067, -0.43198681, -0.93733525,
        0.37859944, -0.30048838, -0.66467839,  0.18476482,  1.00505781,
       -0.32252848,  0.37282225, -0.25394279, -1.34661531, -0.52854782,
        1.13223743,  0.99049121,  0.46284243, -0.1918252 ,  0.13938105,
       -0.48491701,  0.51925433,  1.20754588, -0.96833384,  0.79104269,
       -0.73094076,  0.47804666, -0.83540857,  0.28851396,  0.63589162,...., dtype=float32)</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Finding Most Similar Words</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Finding-Most-Similar-Words">Finding Most Similar Words<a class="anchor-link" href="#Finding-Most-Similar-Words">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 61px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The results produced by Doc2vec are very impressive. To showcase, we'll start with the <span class="cm-comment">`most_similar`</span> method which finds the top n words most similar to the target word. We can see from the following that the results are accurate.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 91px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>The results produced by Doc2vec are very impressive. To showcase, we'll start with the <code>most_similar</code> method which finds the top n words most similar to the target word. We can see from the following that the results are accurate.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[10]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 233.851px; margin-bottom: 0px; border-right-width: 30px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">wv</span>.<span class="cm-property">most_similar</span>(<span class="cm-string">'house'</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 57px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[10]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[('crib', 0.4296485483646393),
 ('room', 0.33615612983703613),
 ('club', 0.30419921875),
 ('place', 0.29620522260665894),
 ('mansion', 0.2891782522201538),
 ('spot', 0.2849082350730896),
 ('garage', 0.28439778089523315),
 ('town', 0.2630491256713867),
 ('south', 0.2609255313873291),
 ('trunk', 0.26089051365852356)]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[11]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 226.16px; margin-bottom: 0px; border-right-width: 30px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">wv</span>.<span class="cm-property">most_similar</span>(<span class="cm-string">'weed'</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 57px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[11]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[('tree', 0.45602014660835266),
 ('chronic', 0.3657829761505127),
 ('bud', 0.34473711252212524),
 ('reefer', 0.33160412311553955),
 ('blantz', 0.32347556948661804),
 ('dope', 0.3029516637325287),
 ('blunts', 0.2944639325141907),
 ('blunt', 0.2931532859802246),
 ('hahahahahaaa', 0.2876523733139038),
 ('drug', 0.2835467457771301)]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 61px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">I found this next result to be very interesting. There apparently is a double meaning to the word 'seed' and our model captures both meanings, an offspring and another word for weed. That's cool!</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 91px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>I found this next result to be very interesting. There apparently is a double meaning to the word 'seed' and our model captures both meanings, an offspring and another word for weed. That's cool!</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[12]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 226.16px; margin-bottom: 0px; border-right-width: 30px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">wv</span>.<span class="cm-property">most_similar</span>(<span class="cm-string">'seed'</span>)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 57px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[12]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[('child', 0.30444782972335815),
 ('greed', 0.2916702926158905),
 ('leaf', 0.2634624242782593),
 ('weed', 0.262786328792572),
 ('breed', 0.25418415665626526),
 ('dream', 0.24939578771591187),
 ('loyalty', 0.2438662201166153),
 ('daughter', 0.23810240626335144),
 ('tree', 0.23642070591449738),
 ('kid', 0.2338743656873703)]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 111px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Even more interesting are the results we get from using the <span class="cm-comment">`positive`</span> and <span class="cm-comment">`negative`</span> keywords. We'll use the "seed" example. The positive words contribute positively towards the similarity score; the negative words contribute negatively. When we use "seed" as our target word and don't specify a <span class="cm-comment">`negative`</span> word, we get a double meaning. But when we add "weed" as a <span class="cm-comment">`negative`</span> word, the meaning becomes much more about offspring. </span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 141px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Even more interesting are the results we get from using the <code>positive</code> and <code>negative</code> keywords. We'll use the "seed" example. The positive words contribute positively towards the similarity score; the negative words contribute negatively. When we use "seed" as our target word and don't specify a <code>negative</code> word, we get a double meaning. But when we add "weed" as a <code>negative</code> word, the meaning becomes much more about offspring. </p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[13]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 226.16px; margin-bottom: 0px; border-right-width: 30px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">wv</span>.<span class="cm-property">most_similar</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">positive</span>=[<span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>[<span class="cm-string">'seed'</span>]],</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">negative</span>=[<span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>[<span class="cm-string">'weed'</span>]]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 106px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[13]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[('seed', 0.7398009300231934),
 ('responsibility', 0.26197338104248047),
 ('fetus', 0.25151997804641724),
 ('child', 0.24744100868701935),
 ('breddern', 0.23935382068157196),
 ('loyalty', 0.2368765026330948),
 ('embrace', 0.2257089465856552),
 ('yosemite', 0.22085259854793549),
 ('pallbearer', 0.2204713225364685),
 ('decomposed', 0.21810504794120789)]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 61px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Here are a couple more things you can do with the word vectors. The first will find the word that doesn't match. The second will find the word most similar to the target word.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 91px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Here are a couple more things you can do with the word vectors. The first will find the word that doesn't match. The second will find the word most similar to the target word.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[14]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 457.01px; margin-bottom: 0px; border-right-width: 30px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">wv</span>.<span class="cm-property">doesnt_match</span>([<span class="cm-string">'south'</span>, <span class="cm-string">'east'</span>, <span class="cm-string">'west'</span>, <span class="cm-string">'atlanta'</span>])</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 57px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[14]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>'atlanta'</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[15]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 564.736px; margin-bottom: 0px; border-right-width: 30px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">wv</span>.<span class="cm-property">most_similar_to_given</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">'god'</span>, </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    [<span class="cm-string">'street'</span>, <span class="cm-string">'house'</span>, <span class="cm-string">'baby'</span>, <span class="cm-string">'church'</span>, <span class="cm-string">'party'</span>, <span class="cm-string">'struggle'</span>, <span class="cm-string">'loyalty'</span>]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 106px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[15]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>'church'</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Finding Most Similar Documents</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Finding-Most-Similar-Documents">Finding Most Similar Documents<a class="anchor-link" href="#Finding-Most-Similar-Documents">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 44px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's first define a helper function so we can look up song titles given the song IDs.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 74px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Let's first define a helper function so we can look up song titles given the song IDs.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[16]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59662px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 310.778px; margin-bottom: 0px; border-right-width: 30px; min-height: 191px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">def</span> <span class="cm-def">print_titles</span>(<span class="cm-variable">results</span>):</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">lookup</span> = <span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">df_train</span>[</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">df_train</span>.<span class="cm-property">song_id</span>==<span class="cm-builtin">int</span>(<span class="cm-variable">x</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    ].<span class="cm-property">song</span>.<span class="cm-property">values</span>[<span class="cm-number">0</span>]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> [</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        [</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">i</span>[<span class="cm-number">0</span>].<span class="cm-property">split</span>(<span class="cm-string">'|'</span>)[<span class="cm-number">0</span>], </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">lookup</span>(<span class="cm-variable">i</span>[<span class="cm-number">0</span>].<span class="cm-property">split</span>(<span class="cm-string">'|'</span>)[<span class="cm-number">1</span>]), </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-variable">i</span>[<span class="cm-number">1</span>]</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        ] <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">results</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    ]</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 221px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div>
        <div class="output" style="display: none;"></div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 61px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We can also find the top n most similar <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">i</span><span class="cm-tag cm-bracket">&gt;</span>songs<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">i</span><span class="cm-tag cm-bracket">&gt;</span> to a target word. When we pass in 'midwest' as our target word, it should be no surprise that Tech N9ne and Nelly have an appearance since both rappers are from and rap about the Midwest.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 91px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>We can also find the top n most similar <i>songs</i> to a target word. When we pass in 'midwest' as our target word, it should be no surprise that Tech N9ne and Nelly have an appearance since both rappers are from and rap about the Midwest.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[17]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 457.01px; margin-bottom: 0px; border-right-width: 30px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">print_titles</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">model</span>.<span class="cm-property">docvecs</span>.<span class="cm-property">most_similar</span>([<span class="cm-variable">model</span>[<span class="cm-string">'midwest'</span>]], <span class="cm-variable">topn</span>=<span class="cm-number">10</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 90px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[17]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[['Tech_N9ne', 'Planet Rock 2K (Down South Mix)', 0.24092429876327515],
 ['Tech_N9ne', 'Strange', 0.24040183424949646],
 ['Tech_N9ne', 'Planet Rock 2K (Original Version)', 0.2370171993970871],
 ['Tech_N9ne', 'Strangeulation I', 0.2366243600845337],
 ['Warren_G', 'Gangsta Love', 0.23494234681129456],
 ['Tech_N9ne', "Now It's On", 0.2246299684047699],
 ['Tech_N9ne', 'P.R. 2K1', 0.22402459383010864],
 ['Nelly', 'L.A.', 0.2188049554824829],
 ['Lil_Wayne', 'Banned From TV', 0.21523958444595337],
 ['Method_Man', "Release Yo' Delf", 0.21435599029064178]]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59033px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 44px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Also not surprising is that when our target word is 'eminem', Eminem and Eminem's band D12 dominate the results.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 74px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Also not surprising is that when our target word is 'eminem', Eminem and Eminem's band D12 dominate the results.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[18]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 449.302px; margin-bottom: 0px; border-right-width: 30px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">print_titles</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">model</span>.<span class="cm-property">docvecs</span>.<span class="cm-property">most_similar</span>([<span class="cm-variable">model</span>[<span class="cm-string">'eminem'</span>]], <span class="cm-variable">topn</span>=<span class="cm-number">10</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 90px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[18]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[['Eminem', 'Ken Kaniff (Skit)', 0.26885756850242615],
 ['Eminem', 'Ken Kaniff (Skit)', 0.2669536769390106],
 ['D12', 'Commercial Break', 0.25570592284202576],
 ['Eminem', 'The Kiss (Skit)', 0.2381049543619156],
 ['D12', 'Steve Berman (Skit)', 0.2308967411518097],
 ['D12', 'Words Are Weapons', 0.2302926629781723],
 ['D12', 'American Psycho II', 0.2270514965057373],
 ['Eminem', "Drop the Bomb On 'Em", 0.2205711007118225],
 ['Eminem', 'My Name Is', 0.21902979910373688],
 ['Fat_Joe', 'My Fofo', 0.21522411704063416]]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 78px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The next one is probably the most fascinating result. When our target word is "church", we get results that clearly have an element of "church" in them. Just look at the first two results, The Game's Hallelujah and Ice Cube's When I Get to Heaven. </span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 108px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>The next one is probably the most fascinating result. When our target word is "church", we get results that clearly have an element of "church" in them. Just look at the first two results, The Game's Hallelujah and Ice Cube's When I Get to Heaven. </p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[19]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 449.302px; margin-bottom: 0px; border-right-width: 30px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">print_titles</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">model</span>.<span class="cm-property">docvecs</span>.<span class="cm-property">most_similar</span>([<span class="cm-variable">model</span>[<span class="cm-string">'church'</span>]], <span class="cm-variable">topn</span>=<span class="cm-number">10</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 90px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[19]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[['The_Game', 'Hallelujah', 0.2645237445831299],
 ['Ice_Cube', 'When I Get to Heaven', 0.2541915774345398],
 ['Yelawolf', 'The Last Song', 0.21845132112503052],
 ['Scarface', 'Crack', 0.21555303037166595],
 ['Lauryn_Hill', 'Interlude 5', 0.21299612522125244],
 ['KRS-One', "Ain't Ready", 0.21055129170417786],
 ['Missy_Elliott', 'Intro', 0.20643793046474457],
 ['Talib_Kweli', "Give 'Em Hell", 0.19774499535560608],
 ['Tech_N9ne', 'Sad Circus', 0.1967805027961731],
 ['Tech_N9ne', 'Show Me a God', 0.19402025640010834]]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 44px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We can also find songs that are semantically similar to each other by looking up a word vector using the document tag.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 74px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>We can also find songs that are semantically similar to each other by looking up a word vector using the document tag.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[20]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 549.354px; margin-bottom: 0px; border-right-width: 30px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">print_titles</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">model</span>.<span class="cm-property">docvecs</span>.<span class="cm-property">most_similar</span>([<span class="cm-variable">model</span>.<span class="cm-property">docvecs</span>[<span class="cm-string">'Eminem|3006'</span>]], <span class="cm-variable">topn</span>=<span class="cm-number">10</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 90px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[20]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[['Eminem', 'The Way I Am', 0.9999999403953552],
 ['Eminem', 'The Way I Am (Danny Lohner Remix)', 0.9738667011260986],
 ['Eminem', 'The Way I Am', 0.9721589088439941],
 ['Nas', 'Album Intro', 0.5593523383140564],
 ['Immortal_Technique', 'Understand Why', 0.4280475974082947],
 ['Nate_Dogg', "I Don't Wanna Hurt No More", 0.41760876774787903],
 ['LL_Cool_J', 'Skit', 0.41418007016181946],
 ['Big_L', 'Platinum Plus', 0.4120897054672241],
 ['Big_L', 'Platinum Plus', 0.4068526029586792],
 ['Gang_Starr', 'My Advice 2 You', 0.40361344814300537]]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 94px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Many of these are duplicates due to the lyrics site that powers Cypher being community generated, but you get the idea. We can also detect which documents do not belong in a list of documents by using the <span class="cm-comment">`doesnt_match`</span> method. Here, we choose which song doesn't match among Eminem's The Way I Am, The Game's Hallelujah and Ice Cube's When I Get to Heaven. The result seems sensible.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 124px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Many of these are duplicates due to the lyrics site that powers Cypher being community generated, but you get the idea. We can also detect which documents do not belong in a list of documents by using the <code>doesnt_match</code> method. Here, we choose which song doesn't match among Eminem's The Way I Am, The Game's Hallelujah and Ice Cube's When I Get to Heaven. The result seems sensible.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[21]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 595.222px; margin-bottom: 0px; border-right-width: 30px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">model</span>.<span class="cm-property">docvecs</span>.<span class="cm-property">doesnt_match</span>([<span class="cm-string">'Eminem|3006'</span>, <span class="cm-string">'The_Game|10060'</span>, <span class="cm-string">'Ice_Cube|644'</span>])</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 57px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[21]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>'Eminem|3006'</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Inferring Vectors</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Inferring-Vectors">Inferring Vectors<a class="anchor-link" href="#Inferring-Vectors">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 78px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Lastly, we'll use our test data to see which songs are the most semantically similar to each other. First, let's load our test data then choose a song as input into the <span class="cm-comment">`infer_vector`</span> method. We'll choose Eminem's Just the Two of Us, which is <span class="cm-comment">`song_id`</span> 1644.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 108px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Lastly, we'll use our test data to see which songs are the most semantically similar to each other. First, let's load our test data then choose a song as input into the <code>infer_vector</code> method. We'll choose Eminem's Just the Two of Us, which is <code>song_id</code> 1644.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[22]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 464.753px; margin-bottom: 0px; border-right-width: 30px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">filename</span> = <span class="cm-string">'lyrics_test.csv'</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">test_sentences</span> = <span class="cm-variable">Sentences</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">filename</span>=<span class="cm-variable cm-cm-overlay cm-matchhighlight">filename</span>, <span class="cm-variable">column</span>=<span class="cm-string">'word'</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">filename</span>)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lyrics_str</span> = <span class="cm-variable">df</span>[<span class="cm-variable">df</span>.<span class="cm-property">song_id</span>==<span class="cm-number">1644</span>].<span class="cm-property">word</span>.<span class="cm-property">values</span>[<span class="cm-number">0</span>]</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 106px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div>
        <div class="output" style="display: none;"></div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 78px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Next, we'll feed the lyrics into <span class="cm-comment">`infer_vector`</span> to return a vector representation of the song. We'll then input that vector representation into <span class="cm-comment">`model.docvecs.most_similar`</span> to return back the 10 most similar songs. You can look all the songs up using the ID.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 108px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Next, we'll feed the lyrics into <code>infer_vector</code> to return a vector representation of the song. We'll then input that vector representation into <code>model.docvecs.most_similar</code> to return back the 10 most similar songs. You can look all the songs up using the ID.</p>
        </div>
    </div>
</div>
<div class="cell code_cell un rendered" tabs="2">
    <div class="input">
        <div class="prompt input_prompt">In&nbsp;[23]:</div>
        <div class="inner_cell">
            <div class="input_area">
                <div class="CodeMirror cm-s-ipython">
                    <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59658px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                    <div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;">
                        <div style="min-width: 1px; height: 0px;"></div>
                    </div>
                    <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                    <div class="CodeMirror-scroll" tabs="-1">
                        <div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 371.889px; margin-bottom: 0px; border-right-width: 30px; min-height: 175px; padding-right: 0px; padding-bottom: 0px;">
                            <div style="position: relative; top: 0px;">
                                <div class="CodeMirror-lines">
                                    <div style="position: relative; outline: none;">
                                        <div class="CodeMirror-measure"></div>
                                        <div class="CodeMirror-measure"></div>
                                        <div style="position: relative; z-index: 1;"></div>
                                        <div class="CodeMirror-cursors"></div>
                                        <div class="CodeMirror-code" style="">
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">word_sample</span> = <span class="cm-variable">sentence</span>.<span class="cm-property">words</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">ivec</span> = <span class="cm-variable">model</span>.<span class="cm-property">infer_vector</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">doc_words</span>=<span class="cm-variable">lyrics_str</span>, </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">steps</span>=<span class="cm-number">500</span>, </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">alpha</span>=<span class="cm-number">0.5</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">print_titles</span>(</span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">model</span>.<span class="cm-property">docvecs</span>.<span class="cm-property">most_similar</span>([<span class="cm-variable">ivec</span>], <span class="cm-variable">topn</span>=<span class="cm-number">10</span>) </span></pre>
                                            <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="CodeMirror-gutters" style="display: none; height: 205px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="output_wrapper">
        <div class=" prompt" title="click to expand output; double click to hide output" style=""></div>
        <div class="output" style="">
            <div class="output_area">
                <div class="prompt output_prompt">Out[23]:</div>
                <div class="output_subarea output_text output_result">
                    <pre>[['Gang_Starr', 'Daily Operation (Intro)', 0.6264939308166504],
 ['Gang_Starr', 'My Advice 2 You', 0.6025712490081787],
 ['De_La_Soul', 'The Dawn Brings Smoke', 0.6022455096244812],
 ['De_La_Soul', 'Stickabush', 0.574888288974762],
 ['Fabolous', 'Niggas Know', 0.5698577761650085],
 ['Too_$hort', "Can't Stay Away (Outro)", 0.5679160356521606],
 ['Immortal_Technique', 'Apocrypha (Interlude)', 0.5677438378334045],
 ['Twista', 'Wide Open', 0.5660445690155029],
 ['Big_Daddy_Kane', 'Looks Like A Job For...', 0.5610144734382629],
 ['Method_Man', 'Dooney Boy (Skit)', 0.5602116584777832]]</pre>
                </div>
            </div>
        </div>
        <div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 161px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Pretty cool!</span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">As you can see, Doc2Vec provides a lot of insight. But we didn't even get to the good stuff: using this data to train machine learning models. Doc2Vec produces <span class="cm-comment">`numpy`</span> feature vectors which allow us to use them as training data for machine learning algorithms. In the next post, we'll do just this. I'll train a model that predicts an artist given a song's lyrics. To do this, we'll employ two machine learning classification algorithms, Naive Bayes and Support Vector Machines. See you next time.</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 191px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>Pretty cool!</p>
            <p>As you can see, Doc2Vec provides a lot of insight. But we didn't even get to the good stuff: using this data to train machine learning models. Doc2Vec produces <code>numpy</code> feature vectors which allow us to use them as training data for machine learning algorithms. In the next post, we'll do just this. I'll train a model that predicts an artist given a song's lyrics. To do this, we'll employ two machine learning classification algorithms, Naive Bayes and Support Vector Machines. See you next time.</p>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Up Next</span></span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 63px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <h2 id="Up-Next">Up Next<a class="anchor-link" href="#Up-Next">¶</a></h2>
        </div>
    </div>
</div>
<div class="cell text_cell un rendered" tabs="2">
    <div class="prompt input_prompt"></div>
    <div class="inner_cell">
        <div class="input_area">
            <div class="CodeMirror cm-s-default CodeMirror-wrap">
                <div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.58984px; left: 5.59028px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div>
                <div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;">
                    <div style="min-width: 1px; height: 0px;"></div>
                </div>
                <div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div>
                <div class="CodeMirror-gutter-filler" cm-not-content="true"></div>
                <div class="CodeMirror-scroll" tabs="-1">
                    <div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 61px;">
                        <div style="position: relative; top: 0px;">
                            <div class="CodeMirror-lines">
                                <div style="position: relative; outline: none;">
                                    <div class="CodeMirror-measure"></div>
                                    <div class="CodeMirror-measure"></div>
                                    <div style="position: relative; z-index: 1;"></div>
                                    <div class="CodeMirror-cursors"></div>
                                    <div class="CodeMirror-code">
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• Lyric Attribution using Naive Bayes and Support Vector Machines <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• Predicting A Song's Genre Given Its Lyrics <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/&gt;</span></span></pre>
                                        <pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• Topic Modeling with Latent Dirichlet Allocation</span></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="CodeMirror-gutters" style="display: none; height: 91px;"></div>
                </div>
            </div>
        </div>
        <div class="text_cell_render rendered_html" tabs="-1">
            <p>• Lyric Attribution using Naive Bayes and Support Vector Machines <br>
                • Predicting A Song's Genre Given Its Lyrics <br>
                • Topic Modeling with Latent Dirichlet Allocation
            </p>
        </div>
    </div>
</div>