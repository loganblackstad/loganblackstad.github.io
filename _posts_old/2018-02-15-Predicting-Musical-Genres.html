---
title: "Using Naive Bayes to Predict a Song's Genre Given its Lyrics"
author_profile: false
author: Tim Dobbins
excerpt: In this post, we'll implement the popular machine-learning algorithm, naive Bayes, to predict a genre given some lyrics.
categories: [2018, february]
tags: [python, machine-learning, data-science]
---
<link href="/assets/css/keen.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="/assets/css/ipython.css">
<link rel="stylesheet" type="text/css" href="/assets/css/dataTables.bootstrap.min.css"/>


<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/d3.js"></script>
<script src="/assets/js/d3plus.js"></script>
<script type="text/javascript" src="/assets/js/datatables.min.js"></script>
<script type="text/javascript" src="/assets/js/datatables.bootstrap.min.js"></script>

<style>
.chart-stage{
	height: 400px;
	overflow-y: auto;
	margin-right: 5px;
	margin-left: 5px;
}
/*#scatterLeftphrase{
	padding-right:10em
}*/
.center {
    margin: auto;
    margin-top: 20px;
    width: 60%;
    border: 3px solid #3182bd;
    padding: 10px;
}
#text{
	height:360px;
	padding-right: 5px;
	padding-left: 5px;
	overflow-y: auto;
	/*border: 1px solid lightgray;*/
}
.input-xs {
  height: 22px;
  padding: 2px 5px;
  font-size: 12px;
  line-height: 1.5; /* If Placeholder of the input is moved up, rem/modify this. */
  border-radius: 3px;
}
.underline{
	text-decoration: underline;
}
.input-sm{
	height: 20px;
}

table {
    white-space:nowrap;
}
div.output_area {max-height: 350px;}
div.input_area {
    margin: 5px;
}
</style><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-hr">---</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><hr>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 107.094px; left: 82.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 198px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In the <span class="cm-link">[last post]</span><span class="cm-string cm-url">(https://tmthyjames.github.io/posts/Analyzing-Rap-Lyrics-Using-Word-Vectors/)</span> we analyzed rap lyrics using word vectors. We mostly did some first-pass analysis and very little prediction. In this post, we'll actually focus on predictions and visualizing our results. I'll use Python's machine-learning library, <span class="cm-tag cm-bracket"></span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">http://scikit-learn.org/stable/</span><span class="cm-string">"</span><span class="cm-tag cm-bracket"></span>scikit-learn<span class="cm-tag cm-bracket">/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket"></span>, to build a <span class="cm-tag cm-bracket"></span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"</span><span class="cm-string cm-link">https://en.wikipedia.org/wiki/Naive_Bayes_classifier</span><span class="cm-string">"</span><span class="cm-tag cm-bracket"></span>naive Bayes classifier<span class="cm-tag cm-bracket">/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket"></span> to predict a song's genre given its lyrics. To get the data, we'll use <span class="cm-link">[Cypher]</span><span class="cm-string cm-url">(https://github.com/tmthyjames/cypher)</span>, a new Python package <span class="cm-link">[I recently released]</span><span class="cm-string cm-url">(https://tmthyjames.github.io/tools/Cypher/)</span> that retrieves music lyrics. To visualize the results, I'll use <span class="cm-link">[D3]</span><span class="cm-string cm-url">(https://d3js.org/)</span> and <span class="cm-link">[D3Plus]</span><span class="cm-string cm-url">(https://d3plus.org/)</span>, which is a nice wrapper for D3.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>In the <a href="https://tmthyjames.github.io/posts/Analyzing-Rap-Lyrics-Using-Word-Vectors/" target="_blank">last post</a> we analyzed rap lyrics using word vectors. We mostly did some first-pass analysis and very little prediction. In this post, we'll actually focus on predictions and visualizing our results. I'll use Python's machine-learning library, <a href="http://scikit-learn.org/stable/" target="_blank">scikit-learn</a>, to build a <a href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier" target="_blank">naive Bayes classifier</a> to predict a song's genre given its lyrics. To get the data, we'll use <a href="https://github.com/tmthyjames/cypher" target="_blank">Cypher</a>, a new Python package <a href="https://tmthyjames.github.io/tools/Cypher/" target="_blank">I recently released</a> that retrieves music lyrics. To visualize the results, I'll use <a href="https://d3js.org/" target="_blank">D3</a> and <a href="https://d3plus.org/" target="_blank">D3Plus</a>, which is a nice wrapper for D3.</p>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 196px; left: 159.2px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 218px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Contents</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Quick Note on Naive Bayes]</span><span class="cm-string cm-url">(#Quick-Note-on-Naive-Bayes)</span><span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Getting the Data]</span><span class="cm-string cm-url">(#Getting-the-Data)</span><span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Loading the Data]</span><span class="cm-string cm-url">(#Loading-the-Data)</span><span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Splitting the Data]</span><span class="cm-string cm-url">(#Splitting-the-Data)</span><span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Training the Model]</span><span class="cm-string cm-url">(#Training-the-Model)</span><span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Top Hip Hop Songs]</span><span class="cm-string cm-url">(#Top-Hip-Hop-Songs)</span><span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Hip Hop Songs that have Alt Rock and Country Lyrics]</span><span class="cm-string cm-url">(#Hip-Hop-Songs-that-have-Alt-Rock-and-Country-Lyrics)</span><span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Visualizing Our results]</span><span class="cm-string cm-url">(#Visualizing-Our-Results)</span> (With d3.js)<span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">• <span class="cm-link">[Up Next]</span><span class="cm-string cm-url">(#Up-Next)</span><span class="cm-tag cm-bracket"></span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">/</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 248px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Contents">Contents<a class="anchor-link" href="#Contents">¶</a></h2>
<p>• <a href="#Quick-Note-on-Naive-Bayes">Quick Note on Naive Bayes</a><br>
• <a href="#Getting-the-Data">Getting the Data</a><br>
• <a href="#Loading-the-Data">Loading the Data</a><br>
• <a href="#Splitting-the-Data">Splitting the Data</a><br>
• <a href="#Training-the-Model">Training the Model</a><br>
• <a href="#Top-Hip-Hop-Songs">Top Hip Hop Songs</a><br>
• <a href="#Hip-Hop-Songs-that-have-Alt-Rock-and-Country-Lyrics">Hip Hop Songs that have Alt Rock and Country Lyrics</a><br>
• <a href="#Visualizing-Our-Results">Visualizing Our results</a> (With d3.js)<br>
• <a href="#Up-Next">Up Next</a><br></p>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Quick Note on Naive Bayes</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Quick-Note-on-Naive-Bayes">Quick Note on Naive Bayes<a class="anchor-link" href="#Quick-Note-on-Naive-Bayes">¶</a></h2>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 198px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The naive Bayes classifier is based on <span class="cm-link">[Bayes' Theorem]</span><span class="cm-string cm-url">(https://en.wikipedia.org/wiki/Bayes%27_theorem)</span> and known for its simplicity, accuracy, and speed, particularly when it comes to text classification, which is what our aim is for this post. In short, as Wikipedia puts it, Bayes' Theorem describes the probability of an event, based on prior knowledge of conditions that might be related to the event. For example, if a musical genre is related to lyrics, then, with Bayes' Theorem, we can more accuarately assess the probability that a certain song belongs to a particular genre, compared to the assessment of the probability of a genre made without knowledge of a song's lyrics. For more on Bayes' Theorem, check this <span class="cm-link">[post]</span><span class="cm-string cm-url">(https://monkeylearn.com/blog/practical-explanation-naive-bayes-classifier/)</span> out. </span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>The naive Bayes classifier is based on <a href="https://en.wikipedia.org/wiki/Bayes%27_theorem" target="_blank">Bayes' Theorem</a> and known for its simplicity, accuracy, and speed, particularly when it comes to text classification, which is what our aim is for this post. In short, as Wikipedia puts it, Bayes' Theorem describes the probability of an event, based on prior knowledge of conditions that might be related to the event. For example, if a musical genre is related to lyrics, then, with Bayes' Theorem, we can more accuarately assess the probability that a certain song belongs to a particular genre, compared to the assessment of the probability of a genre made without knowledge of a song's lyrics. For more on Bayes' Theorem, check this <a href="https://monkeylearn.com/blog/practical-explanation-naive-bayes-classifier/" target="_blank">post</a> out. </p>
</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Getting the Data</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Getting-the-Data">Getting the Data<a class="anchor-link" href="#Getting-the-Data">¶</a></h2>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 328.094px; left: 67.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 368px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The data was retrieved with <span class="cm-link">[Cypher]</span><span class="cm-string cm-url">(https://github.com/tmthyjames/cypher)</span>. The data and code used for this post is available on the Cypher's <span class="cm-link">[GitHub page]</span><span class="cm-string cm-url">(https://github.com/tmthyjames/cypher/tree/master/notebooks)</span>. Since the data takes so long to retrieve (there are over 900 hundred artists), I plan on adding a feature to Cypher that allows the user to load already-retrieved data if it exists, other wise it will retrieve the data like normal. For now, you can just download it from the <span class="cm-link">[GitHub page]</span><span class="cm-string cm-url">(https://github.com/tmthyjames/cypher/tree/master/notebooks)</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">I started this post with the intention of trying to classify 10 genres: pop, blues, heavy metal, classic rock, indie folk, RnB, punk rock, screamo, country, and rap.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">I ran into a few problems with this as classic rock lyrically was very similar to country; indie folk was also similar to country; punk rock, heavy metal, and screamo were all similar; and RnB and rap were very similar. It's not surprising; as the number of classes grows, it becomes harder to correctly classify. I may write a post on my trouble with this approach if there is interest in it, or just post the results of trying to predict all 10 genres.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Anyways, to get the data, I used <span class="cm-link">[Ranker]</span><span class="cm-string cm-url">(https://ranker.com)</span> to get a list of the top 100 artists of each genre. They have a nice API endpoint you can hit to get all the artists so you don't have to web scrape. </span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 398px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>The data was retrieved with <a href="https://github.com/tmthyjames/cypher" target="_blank">Cypher</a>. The data and code used for this post is available on the Cypher's <a href="https://github.com/tmthyjames/cypher/tree/master/notebooks" target="_blank">GitHub page</a>. Since the data takes so long to retrieve (there are over 900 hundred artists), I plan on adding a feature to Cypher that allows the user to load already-retrieved data if it exists, other wise it will retrieve the data like normal. For now, you can just download it from the <a href="https://github.com/tmthyjames/cypher/tree/master/notebooks" target="_blank">GitHub page</a>.</p>
<p>I started this post with the intention of trying to classify 10 genres: pop, blues, heavy metal, classic rock, indie folk, RnB, punk rock, screamo, country, and rap.</p>
<p>I ran into a few problems with this as classic rock lyrically was very similar to country; indie folk was also similar to country; punk rock, heavy metal, and screamo were all similar; and RnB and rap were very similar. It's not surprising; as the number of classes grows, it becomes harder to correctly classify. I may write a post on my trouble with this approach if there is interest in it, or just post the results of trying to predict all 10 genres.</p>
<p>Anyways, to get the data, I used <a href="https://ranker.com" target="_blank">Ranker</a> to get a list of the top 100 artists of each genre. They have a nice API endpoint you can hit to get all the artists so you don't have to web scrape. </p>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Loading the Data</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Loading-the-Data">Loading the Data<a class="anchor-link" href="#Loading-the-Data">¶</a></h2>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 73.0938px; left: 297.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 96px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To load the data, we'll use <span class="cm-link">[pandas']</span><span class="cm-string cm-url">(https://pandas.pydata.org/)</span> <span class="cm-comment">`read_csv`</span> method. We'll also clean up the genres due to the problems mentioned above about lyrical similarity. The three genres we'll try to predict are country, rap, and alt rock since those genres are clearly different. For our purposes, we'll classify metal, punk, and screamo as "alt rock". Here's how we do it:</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>To load the data, we'll use <a href="https://pandas.pydata.org/" target="_blank">pandas'</a> <code>read_csv</code> method. We'll also clean up the genres due to the problems mentioned above about lyrical similarity. The three genres we'll try to predict are country, rap, and alt rock since those genres are clearly different. For our purposes, we'll classify metal, punk, and screamo as "alt rock". Here's how we do it:</p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[38]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 333.938px; margin-bottom: 0px; border-right-width: 30px; min-height: 215px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-string">'lyrics.csv'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">df</span>[<span class="cm-string">'ranker_genre'</span>] = <span class="cm-variable">np</span>.<span class="cm-property">where</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">df</span>[<span class="cm-string">'ranker_genre'</span>] == <span class="cm-string">'screamo'</span>)<span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">df</span>[<span class="cm-string">'ranker_genre'</span>] == <span class="cm-string">'punk rock'</span>)<span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    (<span class="cm-variable">df</span>[<span class="cm-string">'ranker_genre'</span>] == <span class="cm-string">'heavy metal'</span>), </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">'alt rock'</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">df</span>[<span class="cm-string">'ranker_genre'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 245px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The data is available as one lyric per row. To train our classifier, we'll need to transform it into one <span class="cm-em">*song*</span> per row. We'll also go ahead and convert the data to lowercase with <span class="cm-comment">`.apply(lambda x: x.lower())`</span>. To do that, we do the following:</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>The data is available as one lyric per row. To train our classifier, we'll need to transform it into one <em>song</em> per row. We'll also go ahead and convert the data to lowercase with <code>.apply(lambda x: x.lower())</code>. To do that, we do the following:</p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[39]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 107.594px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 587.859px; margin-bottom: 0px; border-right-width: 30px; min-height: 147px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">group</span> = [<span class="cm-string">'song'</span>, <span class="cm-string">'year'</span>, <span class="cm-string">'album'</span>, <span class="cm-string">'genre'</span>, <span class="cm-string">'artist'</span>, <span class="cm-string">'ranker_genre'</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lyrics_by_song</span> = <span class="cm-variable">df</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">group</span>)<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        .<span class="cm-property">groupby</span>(<span class="cm-variable">group</span>).<span class="cm-property">lyric</span><span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        .<span class="cm-property">apply</span>(<span class="cm-string">' '</span>.<span class="cm-property">join</span>)<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        .<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span>.<span class="cm-property">lower</span>())<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        .<span class="cm-property">reset_index</span>(<span class="cm-variable">name</span>=<span class="cm-string">'lyric'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lyrics_by_song</span>[<span class="cm-string">"lyric"</span>] = <span class="cm-variable">lyrics_by_song</span>[<span class="cm-string">'lyric'</span>].<span class="cm-property">str</span>.<span class="cm-property">replace</span>(<span class="cm-string">r'[^\w\s]'</span>,<span class="cm-string">''</span>)</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Splitting the Data</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Splitting-the-Data">Splitting the Data<a class="anchor-link" href="#Splitting-the-Data">¶</a></h2>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.0938px; left: 159.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 96px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Next we'll split our data into a training set and a testing set using only Country, Alt Rock, and Hip Hop. A quick note: because the lyrics are community-sourced some of the songs have incomplete or incorrect lyrics. A lot of the songs with less than 400 characters are just strings of nonsense characters. Therefore, I filtered those songs out as they didn't contribute any value or insight to the model.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Next we'll split our data into a training set and a testing set using only Country, Alt Rock, and Hip Hop. A quick note: because the lyrics are community-sourced some of the songs have incomplete or incorrect lyrics. A lot of the songs with less than 400 characters are just strings of nonsense characters. Therefore, I filtered those songs out as they didn't contribute any value or insight to the model.</p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[40]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 396.594px; left: 221.078px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 595.609px; margin-bottom: 0px; border-right-width: 30px; min-height: 436px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">utils</span> <span class="cm-keyword">import</span> <span class="cm-variable">shuffle</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">nltk</span>.<span class="cm-property">corpus</span> <span class="cm-keyword">import</span> <span class="cm-variable">stopwords</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">genres</span> = [</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">'Country'</span>, <span class="cm-string">'alt rock'</span>, <span class="cm-string">'Hip Hop'</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">LYRIC_LEN</span> = <span class="cm-number">400</span> <span class="cm-comment"># each song has to be  400 characters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">N</span> = <span class="cm-number">10000</span> <span class="cm-comment"># number of records to pull from each genre</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">RANDOM_SEED</span> = <span class="cm-number">200</span> <span class="cm-comment"># random seed to make results repeatable</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">train_df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">test_df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">genre</span> <span class="cm-keyword">in</span> <span class="cm-variable">genres</span>: <span class="cm-comment"># loop over each genre</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">subset</span> = <span class="cm-variable">lyrics_by_song</span>[ <span class="cm-comment"># create a subset </span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        (<span class="cm-variable">lyrics_by_song</span>.<span class="cm-property">ranker_genre</span>==<span class="cm-variable">genre</span>) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        (<span class="cm-variable">lyrics_by_song</span>.<span class="cm-property">lyric</span>.<span class="cm-property">str</span>.<span class="cm-property">len</span>() <span class="cm-operator"></span> <span class="cm-variable">LYRIC_LEN</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    ]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">train_set</span> = <span class="cm-variable">subset</span>.<span class="cm-property">sample</span>(<span class="cm-variable">n</span>=<span class="cm-variable">N</span>, <span class="cm-variable">random_state</span>=<span class="cm-variable">RANDOM_SEED</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">test_set</span> = <span class="cm-variable">subset</span>.<span class="cm-property">drop</span>(<span class="cm-variable">train_set</span>.<span class="cm-property">index</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">train_df</span> = <span class="cm-variable">train_df</span>.<span class="cm-property">append</span>(<span class="cm-variable">train_set</span>) <span class="cm-comment"># append subsets to the master sets</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">test_df</span> = <span class="cm-variable">test_df</span>.<span class="cm-property">append</span>(<span class="cm-variable">test_set</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">train_df</span> = <span class="cm-variable">shuffle</span>(<span class="cm-variable">train_df</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">test_df</span> = <span class="cm-variable">shuffle</span>(<span class="cm-variable">test_df</span>)</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 466px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Training the Model</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Training-the-Model">Training the Model<a class="anchor-link" href="#Training-the-Model">¶</a></h2>
</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Next, we'll train a model using word frequencies and <span class="cm-comment">`sklearn`</span>'s <span class="cm-comment">`CountVectorizer`</span>. The <span class="cm-comment">`CountVectorizer`</span> is a quick and dirty way to train a language model by using simple word counts. Later we'll try a more sophisticated approach with the <span class="cm-comment">`TfidfVectorizer`</span>.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Next, we'll train a model using word frequencies and <code>sklearn</code>'s <code>CountVectorizer</code>. The <code>CountVectorizer</code> is a quick and dirty way to train a language model by using simple word counts. Later we'll try a more sophisticated approach with the <code>TfidfVectorizer</code>.</p>
</div></div></div><div class="cell code_cell un rendered" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[31]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 457px; margin-bottom: 0px; border-right-width: 30px; min-height: 266px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">feature_extraction</span>.<span class="cm-property">text</span> <span class="cm-keyword">import</span> <span class="cm-variable">CountVectorizer</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">naive_bayes</span> <span class="cm-keyword">import</span> <span class="cm-variable">MultinomialNB</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">pipeline</span> <span class="cm-keyword">import</span> <span class="cm-variable">Pipeline</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># define our model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text_clf</span> = <span class="cm-variable">Pipeline</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    [(<span class="cm-string">'vect'</span>, <span class="cm-variable">CountVectorizer</span>()),</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">     (<span class="cm-string">'clf'</span>, <span class="cm-variable">MultinomialNB</span>(<span class="cm-variable">alpha</span>=<span class="cm-number">0.1</span>))])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># train our model on training data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text_clf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train_df</span>.<span class="cm-property">lyric</span>, <span class="cm-variable">train_df</span>.<span class="cm-property">ranker_genre</span>)  </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># score our model on testing data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">predicted</span> = <span class="cm-variable">text_clf</span>.<span class="cm-property">predict</span>(<span class="cm-variable">test_df</span>.<span class="cm-property">lyric</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">mean</span>(<span class="cm-variable">predicted</span> == <span class="cm-variable">test_df</span>.<span class="cm-property">ranker_genre</span>)</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[31]:</div><div class="output_subarea output_text output_result"><pre>0.87216733086518738</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 192.094px; left: 267.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 266px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Not a bad first-pass model!</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Word frequencies work fine here, but let's see if we can get a better model by using the <span class="cm-comment">`TfidfVectorizer`</span>.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">`tf-idf`</span> stands for "term frequency-inverse document frequency". <span class="cm-comment">`tf`</span> summarizes how often a given word appears within a document, while <span class="cm-comment">`idf`</span> scales down words that appear frequently across documents. For example, if we were trying to figure out which rap artists were lyrically similar, the term <span class="cm-comment">`police`</span> may not be very helpful as almost every rapper uses this term. But the term <span class="cm-comment">`detroit`</span> may carry more weight as only a hand full of rappers use it. Thus, although <span class="cm-comment">`police`</span> would have a higher <span class="cm-comment">`tf`</span> score, <span class="cm-comment">`detroit`</span> would have a higher <span class="cm-comment">`tf-idf`</span> score and would be a more important feature in a language model.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">So let's train a model using <span class="cm-comment">`tf-idf`</span> scores as features.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Not a bad first-pass model!</p>
<p>Word frequencies work fine here, but let's see if we can get a better model by using the <code>TfidfVectorizer</code>.</p>
<p><code>tf-idf</code> stands for "term frequency-inverse document frequency". <code>tf</code> summarizes how often a given word appears within a document, while <code>idf</code> scales down words that appear frequently across documents. For example, if we were trying to figure out which rap artists were lyrically similar, the term <code>police</code> may not be very helpful as almost every rapper uses this term. But the term <code>detroit</code> may carry more weight as only a hand full of rappers use it. Thus, although <code>police</code> would have a higher <code>tf</code> score, <code>detroit</code> would have a higher <code>tf-idf</code> score and would be a more important feature in a language model.</p>
<p>So let's train a model using <code>tf-idf</code> scores as features.</p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[7]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 595.594px; margin-bottom: 0px; border-right-width: 30px; min-height: 266px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">naive_bayes</span> <span class="cm-keyword">import</span> <span class="cm-variable">MultinomialNB</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">pipeline</span> <span class="cm-keyword">import</span> <span class="cm-variable">Pipeline</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">feature_extraction</span>.<span class="cm-property">text</span> <span class="cm-keyword">import</span> <span class="cm-variable">TfidfTransformer</span>, <span class="cm-variable">TfidfVectorizer</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># define our model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text_clf</span> = <span class="cm-variable">Pipeline</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    [(<span class="cm-string">'vect'</span>, <span class="cm-variable">TfidfVectorizer</span>()),</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">     (<span class="cm-string">'clf'</span>, <span class="cm-variable">MultinomialNB</span>(<span class="cm-variable">alpha</span>=<span class="cm-number">0.1</span>))])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># train our model on training data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text_clf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train_df</span>.<span class="cm-property">lyric</span>, <span class="cm-variable">train_df</span>.<span class="cm-property">ranker_genre</span>)  </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># score our model on testing data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">predicted</span> = <span class="cm-variable">text_clf</span>.<span class="cm-property">predict</span>(<span class="cm-variable">test_df</span>.<span class="cm-property">lyric</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">mean</span>(<span class="cm-variable">predicted</span> == <span class="cm-variable">test_df</span>.<span class="cm-property">ranker_genre</span>)</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[7]:</div><div class="output_subarea output_text output_result"><pre>0.8641969486169736</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Hmmm. Our model seems to have gotten worse. Let's try tuning a few hyperparameters, lemmatizing our data, customizing our tokenizer a bit, and filtering our words with <span class="cm-comment">`nltk`</span>'s builtin stopword list.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Hmmm. Our model seems to have gotten worse. Let's try tuning a few hyperparameters, lemmatizing our data, customizing our tokenizer a bit, and filtering our words with <code>nltk</code>'s builtin stopword list.</p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[99]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 90.5938px; left: 436.516px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 587.953px; margin-bottom: 0px; border-right-width: 30px; min-height: 555px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">naive_bayes</span> <span class="cm-keyword">import</span> <span class="cm-variable">MultinomialNB</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">pipeline</span> <span class="cm-keyword">import</span> <span class="cm-variable">Pipeline</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">nltk</span> <span class="cm-keyword">import</span> <span class="cm-variable">word_tokenize</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">nltk</span>.<span class="cm-property">stem</span> <span class="cm-keyword">import</span> <span class="cm-variable">WordNetLemmatizer</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">stop</span> = <span class="cm-builtin">list</span>(<span class="cm-builtin">set</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">stopwords</span>.<span class="cm-property">words</span>(<span class="cm-string">'english'</span>))) <span class="cm-comment"># </span><span class="cm-comment cm-cm-overlay cm-matchhighlight">stopwords</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">wnl</span> = <span class="cm-variable">WordNetLemmatizer</span>() <span class="cm-comment"># lemmatizer</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">tokenizer</span>(<span class="cm-variable">x</span>): <span class="cm-comment"># custom tokenizer</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> (</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">wnl</span>.<span class="cm-property">lemmatize</span>(<span class="cm-variable">w</span>) </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">for</span> <span class="cm-variable">w</span> <span class="cm-keyword">in</span> <span class="cm-variable">word_tokenize</span>(<span class="cm-variable">x</span>) </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-builtin">len</span>(<span class="cm-variable">w</span>) <span class="cm-operator"></span> <span class="cm-number">2</span> <span class="cm-keyword">and</span> <span class="cm-variable">w</span>.<span class="cm-property">isalnum</span>() <span class="cm-comment"># only words that are  2 characters</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    )                                 <span class="cm-comment"># and is alpha-numeric</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># define our model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text_clf</span> = <span class="cm-variable">Pipeline</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    [(<span class="cm-string">'vect'</span>, <span class="cm-variable">TfidfVectorizer</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">ngram_range</span>=(<span class="cm-number">1</span>, <span class="cm-number">2</span>), <span class="cm-comment"># include bigrams</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">tokenizer</span>=<span class="cm-variable">tokenizer</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">stop_words</span>=<span class="cm-variable">stop</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">max_df</span>=<span class="cm-number">0.4</span>, <span class="cm-comment"># ignore terms that appear in more than 40% of documents</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">min_df</span>=<span class="cm-number">4</span>)), <span class="cm-comment"># ignore terms that appear in less than 4 documents</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">     (<span class="cm-string">'tfidf'</span>, <span class="cm-variable">TfidfTransformer</span>()),</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">     (<span class="cm-string">'clf'</span>, <span class="cm-variable">MultinomialNB</span>(<span class="cm-variable">alpha</span>=<span class="cm-number">0.1</span>))])</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># train our model on training data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text_clf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train_df</span>.<span class="cm-property">lyric</span>, <span class="cm-variable">train_df</span>.<span class="cm-property">ranker_genre</span>)  </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># score our model on testing data</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">predicted</span> = <span class="cm-variable">text_clf</span>.<span class="cm-property">predict</span>(<span class="cm-variable">test_df</span>.<span class="cm-property">lyric</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">np</span>.<span class="cm-property">mean</span>(<span class="cm-variable">predicted</span> == <span class="cm-variable">test_df</span>.<span class="cm-property">ranker_genre</span>)</span></pre><pre class=" CodeMirror-line " style="display: none;"><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-builtin">len</span>(<span class="cm-variable">w</span>) <span class="cm-operator"></span> <span class="cm-number">2</span> <span class="cm-keyword">and</span> <span class="cm-variable">w</span>.<span class="cm-property">isalnum</span>() <span class="cm-comment"># only words that are  2 characters</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 585px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[99]:</div><div class="output_subarea output_text output_result"><pre>0.88133131322658995</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 73.0938px; left: 367.359px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 147px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Hey! 1% better. I'll take it. We could keep tuning these hyperparameters to squeeze out more accuracy. For example, a more fine-tuned stopword list could help a lot; there are a <span class="cm-link">[few strategies]</span><span class="cm-string cm-url">(https://stackoverflow.com/questions/16927494/how-to-select-stop-words-using-tf-idf-non-english-corpus)</span> for constructing a good stopword list. For now, we'll go with our current model.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now let's go beyond raw accuracy and see how it performs by looking at our confusion matrix for this model. </span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Hey! 1% better. I'll take it. We could keep tuning these hyperparameters to squeeze out more accuracy. For example, a more fine-tuned stopword list could help a lot; there are a <a href="https://stackoverflow.com/questions/16927494/how-to-select-stop-words-using-tf-idf-non-english-corpus" target="_blank">few strategies</a> for constructing a good stopword list. For now, we'll go with our current model.</p>
<p>Now let's go beyond raw accuracy and see how it performs by looking at our confusion matrix for this model. </p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[36]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 433.875px; margin-bottom: 0px; border-right-width: 30px; min-height: 147px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">mat</span> = <span class="cm-variable">confusion_matrix</span>(<span class="cm-variable">test_df</span>.<span class="cm-property">ranker_genre</span>, <span class="cm-variable">predicted</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">sns</span>.<span class="cm-property">heatmap</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable cm-cm-overlay cm-matchhighlight">mat</span>.<span class="cm-property">T</span>, <span class="cm-variable">square</span>=<span class="cm-keyword">True</span>, <span class="cm-variable">annot</span>=<span class="cm-keyword">True</span>, <span class="cm-variable">fmt</span>=<span class="cm-string">'d'</span>, <span class="cm-variable">cbar</span>=<span class="cm-keyword">False</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">xticklabels</span>=<span class="cm-variable">genres</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">yticklabels</span>=<span class="cm-variable">genres</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">xlabel</span>(<span class="cm-string">'true label'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">ylabel</span>(<span class="cm-string">'predicted label'</span>);</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_png"><img src="data:image/png;base64,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&#10;"></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 124.094px; left: 498.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 249px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Given this confusion matrix, we can calculate precision, recall, and f-score, which can be better metrics for evaluating a classifier than raw accuracy.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket"></span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span>Recall<span class="cm-tag cm-bracket">/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span> is the ability of the classifier to find all the positive results. That is, to clasify a rap song <span class="cm-em">*as*</span> a rap song. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket"></span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span>Precision<span class="cm-tag cm-bracket">/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span> is the ability of the classifier to not label a negative result as a positive one. That is, to not classify a country song as a rap song.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket"></span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span>F-score<span class="cm-tag cm-bracket">/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span> is the <span class="cm-link">[harmonic mean]</span><span class="cm-string cm-url">(https://en.wikipedia.org/wiki/Harmonic_mean)</span> of precision and recall.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">To compute recall, precision, and f-score, we'll use <span class="cm-comment">`precision_recall_fscore_support`</span> from <span class="cm-comment">`sklearn.metrics`</span>.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 279px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Given this confusion matrix, we can calculate precision, recall, and f-score, which can be better metrics for evaluating a classifier than raw accuracy.</p>
<p><b>Recall</b> is the ability of the classifier to find all the positive results. That is, to clasify a rap song <em>as</em> a rap song. </p>
<p><b>Precision</b> is the ability of the classifier to not label a negative result as a positive one. That is, to not classify a country song as a rap song.</p>
<p><b>F-score</b> is the <a href="https://en.wikipedia.org/wiki/Harmonic_mean" target="_blank">harmonic mean</a> of precision and recall.</p>
<p>To compute recall, precision, and f-score, we'll use <code>precision_recall_fscore_support</code> from <code>sklearn.metrics</code>.</p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[35]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 780.297px; margin-bottom: 0px; border-right-width: 30px; min-height: 198px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword cm-cm-overlay cm-matchhighlight">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">precision_recall_fscore_support</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">precision</span>, <span class="cm-variable">recall</span>, <span class="cm-variable">fscore</span>, <span class="cm-variable">support</span> = <span class="cm-variable">precision_recall_fscore_support</span>(<span class="cm-variable">test_df</span>.<span class="cm-property">ranker_genre</span>, <span class="cm-variable">predicted</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">n</span>,<span class="cm-variable">genre</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable">genres</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">genre</span> = <span class="cm-variable">genre</span>.<span class="cm-property">upper</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-variable">genre</span><span class="cm-operator">+</span><span class="cm-string">'_precision: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">precision</span>[<span class="cm-variable">n</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-variable">genre</span><span class="cm-operator">+</span><span class="cm-string">'_recall: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">recall</span>[<span class="cm-variable">n</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-variable">genre</span><span class="cm-operator">+</span><span class="cm-string">'_fscore: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">fscore</span>[<span class="cm-variable">n</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-variable">genre</span><span class="cm-operator">+</span><span class="cm-string">'_support: {}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">support</span>[<span class="cm-variable">n</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>()</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>COUNTRY_precision: 0.9034659567125178
COUNTRY_recall: 0.9000933248194901
COUNTRY_fscore: 0.9017764873775898
COUNTRY_support: 20359

ALT ROCK_precision: 0.5072796934865901
ALT ROCK_recall: 0.9403409090909091
ALT ROCK_fscore: 0.6590343454454953
ALT ROCK_support: 1408

HIP HOP_precision: 0.9093471353899765
HIP HOP_recall: 0.8597383720930233
HIP HOP_fscore: 0.883847188324949
HIP HOP_support: 20640

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 232px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket"></span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span>Support<span class="cm-tag cm-bracket">/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span> is the number of each class in the actual true set. And the first thing I notice is that there aren't many alt rock songs being scored. Adding more alt rock songs could possibly improve our model. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We do a good job all around on classifying hip hop and country songs. For alt rock songs, the recall score is great; that is, when it's actually an alt rock song, the model classifies it as an alt rock song 94% of the time. But, as we can see from our alt rock precision score and confusion matrix, the model classifies many hip hop songs as alt rock (963, to be exact), which is the main reason this score is so low.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's throw some new data at our model and see how well it does predicting what genre these lyrics belong to. </span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 262px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p><b>Support</b> is the number of each class in the actual true set. And the first thing I notice is that there aren't many alt rock songs being scored. Adding more alt rock songs could possibly improve our model. </p>
<p>We do a good job all around on classifying hip hop and country songs. For alt rock songs, the recall score is great; that is, when it's actually an alt rock song, the model classifies it as an alt rock song 94% of the time. But, as we can see from our alt rock precision score and confusion matrix, the model classifies many hip hop songs as alt rock (963, to be exact), which is the main reason this score is so low.</p>
<p>Let's throw some new data at our model and see how well it does predicting what genre these lyrics belong to. </p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[13]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5938px; left: 351.953px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none; bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1034px; margin-bottom: 0px; border-right-width: 30px; min-height: 249px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text_clf</span>.<span class="cm-property">predict</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    [</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"i stand for the red white and blue"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"flow so smooth they say i rap in cursive"</span>, <span class="cm-comment">#bars *insert fire emoji*</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"take my heart and carve it out"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"there is no end to the madness"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"sitting on my front porch drinking sweet tea"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"sitting on my front porch sippin on cognac"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"dog died and my pick up truck wont start"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"im invisible and the drugs wont help"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"i hope you choke in your sleep thinking of me"</span>,</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-string">"i wonder what genre a song about data science and naive bayes and hyper parameters and maybe a little scatter plots would be"</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    ]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">)</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 279px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[13]:</div><div class="output_subarea output_text output_result"><pre>array(['Country', 'Hip Hop', 'alt rock', 'alt rock', 'Country', 'Hip Hop',
       'Country', 'alt rock', 'alt rock', 'Hip Hop'], 
      dtype='U8')</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This seems to classify lyrics pretty well. Not sure about that last lyric though. But, then again, maybe the classifier does as good a job as any human would do classifying those cool data science lyrics?</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>This seems to classify lyrics pretty well. Not sure about that last lyric though. But, then again, maybe the classifier does as good a job as any human would do classifying those cool data science lyrics?</p>
</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Top Hip Hop Songs</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Top-Hip-Hop-Songs">Top Hip Hop Songs<a class="anchor-link" href="#Top-Hip-Hop-Songs">¶</a></h2>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Let's retrieve the songs with the highest probability of being hip hop. I'm guessing this will be a prolific artist who's language influences the entire genre. First, though, we need to score each song then merge it in to our dataset.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Let's retrieve the songs with the highest probability of being hip hop. I'm guessing this will be a prolific artist who's language influences the entire genre. First, though, we need to score each song then merge it in to our dataset.</p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[100]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 664.812px; margin-bottom: 0px; border-right-width: 30px; min-height: 147px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span> = <span class="cm-variable">train_df</span>.<span class="cm-property">append</span>(<span class="cm-variable">test_df</span>) <span class="cm-comment"># entire dataset</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">predicts</span> = <span class="cm-variable">text_clf</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>.<span class="cm-property">lyric</span>) <span class="cm-comment"># score each song</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>[<span class="cm-string">'Country'</span>], <span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>[<span class="cm-string">'Hip_Hop'</span>], <span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>[<span class="cm-string">'Alt_Rock'</span>] = [<span class="cm-string">''</span>,<span class="cm-string">''</span>,<span class="cm-string">''</span>] <span class="cm-comment"># create empty columns</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">n</span>,<span class="cm-variable">row</span> <span class="cm-keyword">in</span> <span class="cm-builtin">enumerate</span>(<span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>.<span class="cm-property">itertuples</span>()): <span class="cm-comment"># merge scored </span><span class="cm-comment cm-cm-overlay cm-matchhighlight">data</span><span class="cm-comment"> into our dataset</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>.<span class="cm-property">loc</span>[<span class="cm-variable">row</span>.<span class="cm-property">Index</span>, <span class="cm-string">'Country'</span>] = <span class="cm-variable">predicts</span>[<span class="cm-variable">n</span>][<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>.<span class="cm-property">loc</span>[<span class="cm-variable">row</span>.<span class="cm-property">Index</span>, <span class="cm-string">'Hip_Hop'</span>] = <span class="cm-variable">predicts</span>[<span class="cm-variable">n</span>][<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>.<span class="cm-property">loc</span>[<span class="cm-variable">row</span>.<span class="cm-property">Index</span>, <span class="cm-string">'Alt_Rock'</span>] = <span class="cm-variable">predicts</span>[<span class="cm-variable">n</span>][<span class="cm-number">2</span>]</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 28px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The top 20 most-hip hop songs are:</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>The top 20 most-hip hop songs are:</p>
</div></div></div><div class="cell code_cell un rendered" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[48]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 572.469px; margin-bottom: 0px; border-right-width: 30px; min-height: 164px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">columns_of_interest</span> = [</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">'artist'</span>, <span class="cm-string">'song'</span>, <span class="cm-string">'album'</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">'ranker_genre'</span>, <span class="cm-string">'Hip_Hop'</span>, </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-string">'Alt_Rock'</span>, <span class="cm-string">'Country'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">data</span>[<span class="cm-variable cm-cm-overlay cm-matchhighlight">columns_of_interest</span>]<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    .<span class="cm-property">sort_values</span>([<span class="cm-string">'Hip_Hop'</span>, <span class="cm-string">'Alt_Rock'</span>, <span class="cm-string">'Country'</span>], <span class="cm-variable">ascending</span>=[<span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">1</span>])<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    .<span class="cm-property">head</span>(<span class="cm-number">20</span>)</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 194px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to unscroll output; double click to hide" style=""></div><div class="output " style=""><div class="output_area"><div class="prompt output_prompt">Out[48]:</div><div class="output_subarea output_html rendered_html output_result"><div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right">
      <th></th>
      <th>artist</th>
      <th>song</th>
      <th>album</th>
      <th>ranker_genre</th>
      <th>Hip_Hop</th>
      <th>Alt_Rock</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>89883</th>
      <td>Snoop_Dogg</td>
      <td>Set It Off</td>
      <td>Tha Last Meal (2000)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>1.02507e-12</td>
      <td>2.59403e-13</td>
    </tr>
    <tr>
      <th>42315</th>
      <td>2Pac</td>
      <td>Hit 'Em Up</td>
      <td>Live (2004)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>3.22494e-12</td>
      <td>7.39967e-15</td>
    </tr>
    <tr>
      <th>42316</th>
      <td>2Pac</td>
      <td>Hit 'em Up</td>
      <td>Greatest Hits (1998)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>3.25809e-12</td>
      <td>8.41491e-15</td>
    </tr>
    <tr>
      <th>34832</th>
      <td>Too_$hort</td>
      <td>Get In Where You Fit In</td>
      <td>Get In Where You Fit In (1993)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>3.50784e-12</td>
      <td>2.47664e-15</td>
    </tr>
    <tr>
      <th>33580</th>
      <td>Snoop_Dogg</td>
      <td>Freestyle Conversation</td>
      <td>Tha Doggfather (1996)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>3.01647e-12</td>
      <td>9.0946e-13</td>
    </tr>
    <tr>
      <th>25109</th>
      <td>Snoop_Dogg</td>
      <td>Doggy Dogg World</td>
      <td>Doggystyle (1993)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>1.38902e-11</td>
      <td>8.70554e-13</td>
    </tr>
    <tr>
      <th>25110</th>
      <td>Snoop_Dogg</td>
      <td>Doggy Dogg World</td>
      <td>Death Row's Snoop Doggy Dogg At His Best (2001)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>1.53723e-11</td>
      <td>8.72738e-13</td>
    </tr>
    <tr>
      <th>79165</th>
      <td>Twista</td>
      <td>Overdose</td>
      <td>Adrenaline Rush (1997)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>1.76744e-11</td>
      <td>2.68287e-14</td>
    </tr>
    <tr>
      <th>25253</th>
      <td>Snoop_Dogg</td>
      <td>Don Doggy</td>
      <td>Paid Tha Cost To Be Da Bo$$ (2002)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>1.8457e-11</td>
      <td>1.12283e-12</td>
    </tr>
    <tr>
      <th>91632</th>
      <td>MC_Ren</td>
      <td>Shot Caller</td>
      <td>Ruthless for Life (1998)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>2.29e-11</td>
      <td>6.95705e-13</td>
    </tr>
    <tr>
      <th>85027</th>
      <td>Jay-Z</td>
      <td>Reservoir Dogs</td>
      <td>Vol. 2... Hard Knock Life (1998)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>3.23132e-11</td>
      <td>1.87116e-13</td>
    </tr>
    <tr>
      <th>76063</th>
      <td>Scarface</td>
      <td>O.G. To Me</td>
      <td>The Last of a Dying Breed (2000)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>3.2801e-11</td>
      <td>2.43453e-13</td>
    </tr>
    <tr>
      <th>2711</th>
      <td>Krayzie_Bone</td>
      <td>A Thugga Level</td>
      <td>Thug On Da Line (2001)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>4.52958e-11</td>
      <td>7.43026e-13</td>
    </tr>
    <tr>
      <th>119078</th>
      <td>Too_$hort</td>
      <td>What Happened to the Groupies</td>
      <td>Can't Stay Away (1999)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>4.58972e-11</td>
      <td>4.83204e-12</td>
    </tr>
    <tr>
      <th>50805</th>
      <td>T.I.</td>
      <td>I'm Straight</td>
      <td>King (2006)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>4.30728e-11</td>
      <td>7.70825e-12</td>
    </tr>
    <tr>
      <th>19296</th>
      <td>Tech_N9ne</td>
      <td>Come Gangsta</td>
      <td>Bad Season (2010)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>4.98534e-11</td>
      <td>2.54802e-12</td>
    </tr>
    <tr>
      <th>19295</th>
      <td>Tech_N9ne</td>
      <td>Come Gangsta</td>
      <td>Everready (The Religion) (2006)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>4.98534e-11</td>
      <td>2.54802e-12</td>
    </tr>
    <tr>
      <th>97664</th>
      <td>MC_Ren</td>
      <td>Still the Same Nigga</td>
      <td>The Villain in Black (1996)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>6.05274e-11</td>
      <td>2.06619e-12</td>
    </tr>
    <tr>
      <th>3266</th>
      <td>D12</td>
      <td>Activity As Phuctivity</td>
      <td>The Underground EP (1997)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>6.54908e-11</td>
      <td>6.91093e-14</td>
    </tr>
    <tr>
      <th>32646</th>
      <td>Snoop_Dogg</td>
      <td>For All My Niggaz &amp; Bitches</td>
      <td>Doggystyle (1993)</td>
      <td>Hip Hop</td>
      <td>1</td>
      <td>6.36369e-11</td>
      <td>2.30267e-12</td>
    </tr>
  </tbody>
</table>
</div></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 147px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">And the most hip hop song is Set it Off by Snoop Dogg, who also seems to be the most hip hop rapper, as he has 6 of the top 20 most hip hop songs. Also, it shouldn't be surprising that a lot of these songs are pre-2000, which is the age that hip hop really began to take shape. From this analysis, it seems a lot of the language of hip hop was being defined during those years.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Because the lyrics are community-sourced, there are some duplicate songs. In the real world, we'd want to get rid of these duplicate rows.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>And the most hip hop song is Set it Off by Snoop Dogg, who also seems to be the most hip hop rapper, as he has 6 of the top 20 most hip hop songs. Also, it shouldn't be surprising that a lot of these songs are pre-2000, which is the age that hip hop really began to take shape. From this analysis, it seems a lot of the language of hip hop was being defined during those years.</p>
<p>Because the lyrics are community-sourced, there are some duplicate songs. In the real world, we'd want to get rid of these duplicate rows.</p>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Hip Hop Songs that have Alt Rock and Country Lyrics</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Hip-Hop-Songs-that-have-Alt-Rock-and-Country-Lyrics">Hip Hop Songs that have Alt Rock and Country Lyrics<a class="anchor-link" href="#Hip-Hop-Songs-that-have-Alt-Rock-and-Country-Lyrics">¶</a></h2>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.0938px; left: 559.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Next, let's see which hip hop songs have the most alt rock lyrics. To do this, we'll query our data for only hip hop songs and then sort by the <span class="cm-comment">`Alt_Rock`</span> column. I don't have any guesses as to which songs this will be. Maybe songs by Childish Gambino? Or Tech N9ne? Let's see.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Next, let's see which hip hop songs have the most alt rock lyrics. To do this, we'll query our data for only hip hop songs and then sort by the <code>Alt_Rock</code> column. I don't have any guesses as to which songs this will be. Maybe songs by Childish Gambino? Or Tech N9ne? Let's see.</p>
</div></div></div><div class="cell code_cell rendered un" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[116]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 464.734px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>[<span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>.<span class="cm-property">ranker_genre</span>==<span class="cm-string">'Hip Hop'</span>][<span class="cm-variable">columns_of_interest</span>]<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    .<span class="cm-property">sort_values</span>([<span class="cm-string">'Alt_Rock'</span>, <span class="cm-string">'Hip_Hop'</span>], <span class="cm-variable">ascending</span>=[<span class="cm-number">0</span>, <span class="cm-number">1</span>])<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    .<span class="cm-property">head</span>(<span class="cm-number">20</span>) <span class="cm-comment"># Top 20</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to unscroll output; double click to hide" style=""></div><div class="output " style=""><div class="output_area"><div class="prompt output_prompt">Out[116]:</div><div class="output_subarea output_html rendered_html output_result"><div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right">
      <th></th>
      <th>artist</th>
      <th>song</th>
      <th>album</th>
      <th>ranker_genre</th>
      <th>Hip_Hop</th>
      <th>Alt_Rock</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>109588</th>
      <td>Busta_Rhymes</td>
      <td>There's Only One Year Left!!! (Intro)</td>
      <td>E.L.E. (Extinction Level Event): The Final World Front (1998)</td>
      <td>Hip Hop</td>
      <td>0.000587058</td>
      <td>0.999413</td>
      <td>7.39381e-08</td>
    </tr>
    <tr>
      <th>3277</th>
      <td>Lauryn_Hill</td>
      <td>Adam Lives In Theory</td>
      <td>MTV Unplugged (2002)</td>
      <td>Hip Hop</td>
      <td>0.00145159</td>
      <td>0.998285</td>
      <td>0.000263027</td>
    </tr>
    <tr>
      <th>114762</th>
      <td>Immortal_Technique</td>
      <td>Ultimas Palabras</td>
      <td>The Martyr (2011)</td>
      <td>Hip Hop</td>
      <td>0.00282868</td>
      <td>0.997171</td>
      <td>4.61514e-07</td>
    </tr>
    <tr>
      <th>46223</th>
      <td>Lauryn_Hill</td>
      <td>I Get Out</td>
      <td>MTV Unplugged (2002)</td>
      <td>Hip Hop</td>
      <td>0.00272789</td>
      <td>0.996981</td>
      <td>0.000291271</td>
    </tr>
    <tr>
      <th>33562</th>
      <td>Lauryn_Hill</td>
      <td>Freedom Time</td>
      <td>MTV Unplugged (2002)</td>
      <td>Hip Hop</td>
      <td>0.00346428</td>
      <td>0.996294</td>
      <td>0.000241836</td>
    </tr>
    <tr>
      <th>61391</th>
      <td>Lupe_Fiasco</td>
      <td>Letting Go</td>
      <td>Lasers (2011)</td>
      <td>Hip Hop</td>
      <td>0.00417445</td>
      <td>0.994444</td>
      <td>0.00138115</td>
    </tr>
    <tr>
      <th>30230</th>
      <td>Kid_Cudi</td>
      <td>Fade 2 Red</td>
      <td>Speedin' Bullet 2 Heaven (2015)</td>
      <td>Hip Hop</td>
      <td>0.00555762</td>
      <td>0.993203</td>
      <td>0.00123917</td>
    </tr>
    <tr>
      <th>115250</th>
      <td>Lupe_Fiasco</td>
      <td>Unforgivable Youth</td>
      <td>Food &amp; Liquor II: The Great American Rap Album Pt. 1 (2012)</td>
      <td>Hip Hop</td>
      <td>0.00624787</td>
      <td>0.993113</td>
      <td>0.000638979</td>
    </tr>
    <tr>
      <th>20096</th>
      <td>Kid_Cudi</td>
      <td>Copernicus Landing</td>
      <td>Satellite Flight: The Journey to Mother Moon (2014)</td>
      <td>Hip Hop</td>
      <td>0.00505283</td>
      <td>0.993016</td>
      <td>0.00193124</td>
    </tr>
    <tr>
      <th>19897</th>
      <td>Kid_Cudi</td>
      <td>Confused!</td>
      <td>Speedin' Bullet 2 Heaven (2015)</td>
      <td>Hip Hop</td>
      <td>0.00505283</td>
      <td>0.993016</td>
      <td>0.00193124</td>
    </tr>
    <tr>
      <th>68598</th>
      <td>Kid_Cudi</td>
      <td>Melting</td>
      <td>Speedin' Bullet 2 Heaven (2015)</td>
      <td>Hip Hop</td>
      <td>0.00579108</td>
      <td>0.991223</td>
      <td>0.00298592</td>
    </tr>
    <tr>
      <th>76331</th>
      <td>Lauryn_Hill</td>
      <td>Oh Jerusalem</td>
      <td>MTV Unplugged (2002)</td>
      <td>Hip Hop</td>
      <td>0.00301647</td>
      <td>0.991191</td>
      <td>0.00579247</td>
    </tr>
    <tr>
      <th>90235</th>
      <td>Yelawolf</td>
      <td>Shadows</td>
      <td>Trial by Fire (2017)</td>
      <td>Hip Hop</td>
      <td>0.00304338</td>
      <td>0.990284</td>
      <td>0.00667227</td>
    </tr>
    <tr>
      <th>57560</th>
      <td>Lauryn_Hill</td>
      <td>Just Like Water</td>
      <td>MTV Unplugged (2002)</td>
      <td>Hip Hop</td>
      <td>0.00161961</td>
      <td>0.98694</td>
      <td>0.0114401</td>
    </tr>
    <tr>
      <th>81732</th>
      <td>Common</td>
      <td>Pops Belief</td>
      <td>The Dreamer/The Believer (2011)</td>
      <td>Hip Hop</td>
      <td>0.0102264</td>
      <td>0.985932</td>
      <td>0.00384123</td>
    </tr>
    <tr>
      <th>106671</th>
      <td>Tech_N9ne</td>
      <td>The Noose</td>
      <td>Welcome to Strangeland (2011)</td>
      <td>Hip Hop</td>
      <td>0.0164305</td>
      <td>0.982261</td>
      <td>0.00130803</td>
    </tr>
    <tr>
      <th>100753</th>
      <td>Cypress_Hill</td>
      <td>Take My Pain</td>
      <td>Rise Up (2010)</td>
      <td>Hip Hop</td>
      <td>0.018484</td>
      <td>0.98088</td>
      <td>0.000635567</td>
    </tr>
    <tr>
      <th>27546</th>
      <td>Tech_N9ne</td>
      <td>Drowning</td>
      <td>Something Else (2013)</td>
      <td>Hip Hop</td>
      <td>0.0161966</td>
      <td>0.978309</td>
      <td>0.00549422</td>
    </tr>
    <tr>
      <th>28263</th>
      <td>Kid_Cudi</td>
      <td>Edge of the Earth / Post Mortem Boredom</td>
      <td>Speedin' Bullet 2 Heaven (2015)</td>
      <td>Hip Hop</td>
      <td>0.0082987</td>
      <td>0.977075</td>
      <td>0.0146258</td>
    </tr>
    <tr>
      <th>43911</th>
      <td>Chance_The_Rapper</td>
      <td>How Great</td>
      <td>Coloring Book (2016)</td>
      <td>Hip Hop</td>
      <td>0.0240995</td>
      <td>0.972694</td>
      <td>0.00320653</td>
    </tr>
  </tbody>
</table>
</div></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell un rendered" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 130px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Wow. Didn't expect some of these results. Lauryn Hill seems to be the alt rock hip hop queen. Although Busta Rhymes has the most alt rock song, Lauryn Hill has 5 of the top 20 and, as we'll see from our visualization below, 12 of the top 100 most alt rock hip hop songs.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now, let's see which hip hop songs have the most country lyrics. Again, no guesses. Maybe a southern rapper, like Ludacris or Yelawolf?</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Wow. Didn't expect some of these results. Lauryn Hill seems to be the alt rock hip hop queen. Although Busta Rhymes has the most alt rock song, Lauryn Hill has 5 of the top 20 and, as we'll see from our visualization below, 12 of the top 100 most alt rock hip hop songs.</p>
<p>Now, let's see which hip hop songs have the most country lyrics. Again, no guesses. Maybe a southern rapper, like Ludacris or Yelawolf?</p>
</div></div></div><div class="cell code_cell un rendered" tabs="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[117]:</div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 433.953px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>[<span class="cm-variable cm-cm-overlay cm-matchhighlight">data</span>.<span class="cm-property">ranker_genre</span>==<span class="cm-string">'Hip Hop'</span>][<span class="cm-variable">columns_of_interest</span>]<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    .<span class="cm-property">sort_values</span>([<span class="cm-string">'Country'</span>], <span class="cm-variable">ascending</span>=[<span class="cm-number">0</span>])<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    .<span class="cm-property">head</span>(<span class="cm-number">20</span>)</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class=" prompt" title="click to unscroll output; double click to hide" style=""></div><div class="output " style=""><div class="output_area"><div class="prompt output_prompt">Out[117]:</div><div class="output_subarea output_html rendered_html output_result"><div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right">
      <th></th>
      <th>artist</th>
      <th>song</th>
      <th>album</th>
      <th>ranker_genre</th>
      <th>Hip_Hop</th>
      <th>Alt_Rock</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35371</th>
      <td>Ghostface_Killah</td>
      <td>Ghostface X-Mas</td>
      <td>GhostDeini The Great (2008)</td>
      <td>Hip Hop</td>
      <td>0.0104447</td>
      <td>0.00121425</td>
      <td>0.988341</td>
    </tr>
    <tr>
      <th>51878</th>
      <td>Queen_Latifah</td>
      <td>If I Had You</td>
      <td>The Dana Owens Album (2004)</td>
      <td>Hip Hop</td>
      <td>0.0099924</td>
      <td>0.0174937</td>
      <td>0.972514</td>
    </tr>
    <tr>
      <th>25455</th>
      <td>Queen_Latifah</td>
      <td>Don't Cry Baby</td>
      <td>Trav'lin' Light (2007)</td>
      <td>Hip Hop</td>
      <td>0.0229387</td>
      <td>0.0271649</td>
      <td>0.949896</td>
    </tr>
    <tr>
      <th>107717</th>
      <td>Queen_Latifah</td>
      <td>The Same Love That Made Me Laugh</td>
      <td>The Dana Owens Album (2004)</td>
      <td>Hip Hop</td>
      <td>0.0181416</td>
      <td>0.0324947</td>
      <td>0.949364</td>
    </tr>
    <tr>
      <th>8226</th>
      <td>Childish_Gambino</td>
      <td>Baby Boy</td>
      <td>"Awaken, My Love!" (2016)</td>
      <td>Hip Hop</td>
      <td>0.0130007</td>
      <td>0.0379516</td>
      <td>0.949048</td>
    </tr>
    <tr>
      <th>101930</th>
      <td>Yelawolf</td>
      <td>Tennessee Love</td>
      <td>Trunk Muzik Returns (2013)</td>
      <td>Hip Hop</td>
      <td>0.0537624</td>
      <td>0.000793593</td>
      <td>0.945444</td>
    </tr>
    <tr>
      <th>101931</th>
      <td>Yelawolf</td>
      <td>Tennessee Love</td>
      <td>Love Story (2015)</td>
      <td>Hip Hop</td>
      <td>0.0537624</td>
      <td>0.000793593</td>
      <td>0.945444</td>
    </tr>
    <tr>
      <th>56413</th>
      <td>Bizzy_Bone</td>
      <td>Jesus</td>
      <td>The Gift (2001)</td>
      <td>Hip Hop</td>
      <td>0.0556137</td>
      <td>0.0303563</td>
      <td>0.91403</td>
    </tr>
    <tr>
      <th>31606</th>
      <td>Drake</td>
      <td>Find Your Love</td>
      <td>Thank Me Later (2010)</td>
      <td>Hip Hop</td>
      <td>0.0194045</td>
      <td>0.0760984</td>
      <td>0.904497</td>
    </tr>
    <tr>
      <th>94728</th>
      <td>Scarface</td>
      <td>Someday</td>
      <td>The Fix (2002)</td>
      <td>Hip Hop</td>
      <td>0.0289326</td>
      <td>0.0727989</td>
      <td>0.898269</td>
    </tr>
    <tr>
      <th>102174</th>
      <td>DMX</td>
      <td>Thank You</td>
      <td>Grand Champ (2003)</td>
      <td>Hip Hop</td>
      <td>0.0420652</td>
      <td>0.0918535</td>
      <td>0.866081</td>
    </tr>
    <tr>
      <th>85518</th>
      <td>Yelawolf</td>
      <td>Ride or Die</td>
      <td>Trial by Fire (2017)</td>
      <td>Hip Hop</td>
      <td>0.119646</td>
      <td>0.019628</td>
      <td>0.860726</td>
    </tr>
    <tr>
      <th>30491</th>
      <td>DMX</td>
      <td>Fallin'</td>
      <td>For The Love Of Money (2010)</td>
      <td>Hip Hop</td>
      <td>0.0965481</td>
      <td>0.0566869</td>
      <td>0.846765</td>
    </tr>
    <tr>
      <th>56470</th>
      <td>DMX</td>
      <td>Jesus Loves Me</td>
      <td>Walk With Me Now And You'll Fly With Me Later (The Mixtape) (2011)</td>
      <td>Hip Hop</td>
      <td>0.0592676</td>
      <td>0.0952431</td>
      <td>0.845489</td>
    </tr>
    <tr>
      <th>69851</th>
      <td>Eminem</td>
      <td>Mockingbird</td>
      <td>Encore (2004)</td>
      <td>Hip Hop</td>
      <td>0.0682687</td>
      <td>0.0878662</td>
      <td>0.843865</td>
    </tr>
    <tr>
      <th>69854</th>
      <td>Eminem</td>
      <td>Mockingbird</td>
      <td>Curtain Call: The Hits (2005)</td>
      <td>Hip Hop</td>
      <td>0.0682687</td>
      <td>0.0878662</td>
      <td>0.843865</td>
    </tr>
    <tr>
      <th>25638</th>
      <td>Ol%27_Dirty_Bastard</td>
      <td>Don't Go Breaking My Heart</td>
      <td>A Son Unique (2005)</td>
      <td>Hip Hop</td>
      <td>0.0614408</td>
      <td>0.0950812</td>
      <td>0.843478</td>
    </tr>
    <tr>
      <th>51547</th>
      <td>Childish_Gambino</td>
      <td>I. Flight of the Navigator</td>
      <td>Because the Internet (2013)</td>
      <td>Hip Hop</td>
      <td>0.00828495</td>
      <td>0.166198</td>
      <td>0.825517</td>
    </tr>
    <tr>
      <th>4056</th>
      <td>Yelawolf</td>
      <td>Alabama Gotdamn</td>
      <td>Friday The 13th (2011)</td>
      <td>Hip Hop</td>
      <td>0.193608</td>
      <td>0.00277894</td>
      <td>0.803613</td>
    </tr>
    <tr>
      <th>122788</th>
      <td>Will_Smith</td>
      <td>Willow Is a Player</td>
      <td>Born to Reign (2002)</td>
      <td>Hip Hop</td>
      <td>0.105539</td>
      <td>0.0913535</td>
      <td>0.803108</td>
    </tr>
  </tbody>
</table>
</div></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.0938px; left: 67.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Well damn. If Lauryn Hill is the alt rock hip hop queen, then Queen Latifah is the queen of country hip hop, at least lyrically.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Well damn. If Lauryn Hill is the alt rock hip hop queen, then Queen Latifah is the queen of country hip hop, at least lyrically.</p>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Visualizing Our Results</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Visualizing-Our-Results">Visualizing Our Results<a class="anchor-link" href="#Visualizing-Our-Results">¶</a></h2>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 243.594px; left: 590.531px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px; width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 266px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">I've also created a dashboard that you can play around with. It visualizes what we just did with our dataframes. Namely, you can look up which songs are most likely to belong to a different genre. In the upper left quadrant, you have the top 1,000 hip hop songs that have alt rock lyrics; you can also choose which genre you'd like to analyze with the drop down options. In the upper right quandrant, there's a table of the top 100 songs based on the filter of the upper left quadrant. In the lower left quadrant, you can see the lyrics weighted by tf-idf scores to allow you to visualize which words are hip hop, alt rock, and country. Lastly, in the lower right quadrant, you have a scatter plot with the tf-idf scores for each word for each genre. This graph is another way of visualizing the lower left quadrant. </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">With these graphs, you'll get more insight into why exactly the model classified a song a certain way.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket"></span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span>To get started, first select a song from the upper left scatter plot.<span class="cm-tag cm-bracket">/</span><span class="cm-tag">b</span><span class="cm-tag cm-bracket"></span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>I've also created a dashboard that you can play around with. It visualizes what we just did with our dataframes. Namely, you can look up which songs are most likely to belong to a different genre. In the upper left quadrant, you have the top 1,000 hip hop songs that have alt rock lyrics; you can also choose which genre you'd like to analyze with the drop down options. In the upper right quandrant, there's a table of the top 100 songs based on the filter of the upper left quadrant. In the lower left quadrant, you can see the lyrics weighted by tf-idf scores to allow you to visualize which words are hip hop, alt rock, and country. Lastly, in the lower right quadrant, you have a scatter plot with the tf-idf scores for each word for each genre. This graph is another way of visualizing the lower left quadrant. </p>
<p>With these graphs, you'll get more insight into why exactly the model classified a song a certain way.</p>
<p><b>To get started, first select a song from the upper left scatter plot.</b> (Dashboard is best viewed on non-mobile device.)</p>
<p>Try these songs to get you started: <br/>
	Immortal Technique's <button class="btn btn-xs mb-2" style="background-color:#3182bd;" id="ultimasPalabras">Ultimas Palabras</button>, which is a rap song that has lots of alt rock lyrics.<br/>
	Joan Jett and the Blackhearts's <button class="btn btn-xs mb-2" style="background-color:#31a354;" id="newOrleans">New Orleans</button>, an alt rock song with country lyrics.<br/>
	Deftones' <button class="btn btn-xs mb-2" style="background-color:#31a354;" id="blackMoon">Black Moon</button>, an alt rock song with hip hop lyrics.
</p>
</div></div></div>

<svg height="20" width="20">
  <rect width="20" height="20" stroke-width="" fill="#3182bd"/>
</svg> Hip_Hop &emsp;
<svg height="20" width="20">
  <rect width="20" height="20" stroke-width="" fill="#31a354"/>
</svg> Alt_Rock &emsp;
<svg height="20" width="20">
  <rect width="20" height="20" stroke-width="" fill="#e6550d"/>
</svg> Country

<div class="keen-dashboard" style="padding-top:10px;padding-bottom:10px;font-size: 15px;">

  <div class="container-fluid">
    <div class="row">

      <div class="col-sm-6">
        <div class="chart-wrapper">
          <div class="chart-title">
          	<span id="scatterLeftphrase">The most alt rock rappers</span>
          </div>
          <div class="chart-stage">
			<div class="form-inline">
				<select type="text" class="form-control mb-2 mr-sm- input-xs" id="genre2left" placeholder="Genre 1">
				<option selected="selected">Hip_Hop</option>
				<option>Alt_Rock</option>
				<option>Country</option>
				</select> <span>songs that have </span>
				<select type="text" class="form-control mb-2 mr-sm- input-xs" id="genre1left" placeholder="Genre 2">
				<option>Hip_Hop</option>
				<option selected="selected">Alt_Rock</option>
				<option>Country</option>
				</select> <span>lyrics </span>
			  <button class="btn btn-primary btn-xs mb-2" id="submitScatterOne">Submit</button>
			</div>
			<div id="scatterLeft"></div>
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="chart-wrapper">
          <div class="chart-title" id="scatterRightphrase">The top 100 alt rock rappers</div>
          <div class="chart-stage" id="scatterRight">
			<table id="table" class="display table table-striped table-bordered" cellspacing="0" width="100%">
		        <thead>
		            <tr>
		                <th>Genre</th>
		                <th>Artist</th>
		                <th>Song</th>
		                <th>Hip_Hop</th>
		                <th>Alt_Rock</th>
		                <th>Country</th>
		            </tr>
		        </thead>
		    </table>
          </div>
        </div>
      </div>

    </div>
    <div class="row">

      <div class="col-sm-6">
        <div class="chart-wrapper">
          <div class="chart-title" id="tfidf-words">
            The most alt rock words weighted by tf-idf
          </div>
          <div class="chart-stage">
          	<div id="text">
				<div class="center">
				  <p><b>Click on a song in the scatter plot to see more</b></p>
				</div>
			</div>
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="chart-wrapper">
          <div class="chart-title" id="tfidf-scores">
            tf-idf scores for each genre, sized by tf
          </div>
          <div class="chart-stage" id="tfidfchart">
			<div class="center">
			  <p><b>Click on a song in the scatter plot to see more</b></p>
			</div>
          </div>
        </div>
      </div>

    </div>

  </div>
</div>

<div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 28.6875px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-hr">---</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 58px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><hr>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 90.0938px; left: 82.5625px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 198px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style="">
<pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"></span><p>A quick note on the lower right scatter plot. For each genre-word combination, we have a <code>tf-idf</code> score. The genre that has the highest <code>tf-idf</code> score for a given word will have that genre's color (legend at the top). Additionally, the points are sized by <code>tf</code> (term frequency) to show how often that word is used within a certain genre. With this graph, you can get an idea of how lyrically dominant a certain genre is in a given song.</p></pre>
<pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">These results look pretty good, even the alt rock songs. If you choose "Alt_Rock songs that have Hip_Hop lyrics", the top song is Rage Against The Machine's "F\*ck Tha Police" which has obvious hip hop overtones. Some may even say it <span class="cm-em">*is*</span> a hip hop song. Also, among the top of that list are the songs birthed from the Jay-Z-Linkin Park collaboration. Again, arguably hip hop songs, so the classifier does well here.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre>

<pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Also, if you choose "Country songs that have Hip_Hop lyrics" you'll notice that the top song is Taylor Swift's Thug Story featuring T-Pain. The lyrics in the lower left box and the lower right tf-idf scatter plot will show that this song is lyrically hip hop even if musically it couldn't be further from it. </span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></div>

<div class="text_cell_render rendered_html" tabs="-1">
<p>A quick note on the lower right scatter plot. For each genre-word combination, we have a <code>tf-idf</code> score. The genre that has the highest <code>tf-idf</code> score for a given word will have that genre's color (legend at the top). Additionally, the points are sized by <code>tf</code> (term frequency) to show how often that word is used within a certain genre. With this graph, you can get an idea of how lyrically dominant a certain genre is in a given song.</p>
<p>These results look pretty good, even the alt rock songs. If you choose "Alt_Rock songs that have Hip_Hop lyrics", the top song is Rage Against The Machine's <button class="btn btn-xs mb-2" style="background-color:#31a354;" id="fuckThaPolice">Fuck Tha Police</button> which has obvious hip hop overtones. Some may even say it <em>is</em> a hip hop song. Also, among the top of that list are the songs birthed from the Jay-Z-Linkin Park collaboration. Again, arguably hip hop songs, so the classifier does well here.</p>
<p>Also, if you choose "Country songs that have Hip_Hop lyrics" you'll notice that the top song is Taylor Swift's <button class="btn btn-xs mb-2" style="background-color:#e6550d;" id="thugStory">Thug Story</button> featuring T-Pain. The lyrics in the lower left box and the lower right tf-idf scatter plot will show that this song is lyrically hip hop even if musically it couldn't be further from it. </p>
</div></div></div><div class="cell text_cell rendered " tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 33px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Up Next</span></span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 63px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><h2 id="Up-Next">Up Next<a class="anchor-link" href="#Up-Next">¶</a></h2>
</div></div></div><div class="cell text_cell rendered un" tabs="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabs="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="width: 18px; pointer-events: none;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabs="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-cm-overlay cm-matchhighlight">Next</span>, I'd like to perform some topic modeling on musical lyrics. But I may be putting most of my effort into <span class="cm-link">[Achoo]</span><span class="cm-string cm-url">(https://tmthyjames.github.io/tools/prediction/Achoo-beta-0.1/)</span> for the foreseeable future. Either way, I'll be reporting back soon.</span></pre></div></div></div></div></div><div class="CodeMirror-gutters" style="display: none; height: 109px;"></div></div></div></div><div class="text_cell_render rendered_html" tabs="-1"><p>Next, I'd like to perform some topic modeling on musical lyrics. But I may be putting most of my effort into <a href="https://tmthyjames.github.io/tools/prediction/Achoo-beta-0.1/" target="_blank">Achoo</a> for the foreseeable future. Either way, I'll be reporting back soon.</p>
</div></div></div>

<script>

$(document).ready(function(){
	$.noConflict();
	$.get('/assets/data/tfidf_bank10.json', function(tfidfBank){
			
		$.get('/assets/data/data-sample.json', function(data){


			var drillDown = function(d, genre1, genre2, selector){

				table.search(d.song).draw();

				var genreScores = [];

				var lyrics = d.lyric.split(' ');
				var htmlString = '';
				for (var i in lyrics){
					var bgcolor = 'white',
						word = lyrics[i],
						tfidf1 = (tfidfBank[genre1][word] ? tfidfBank[genre1][word].tfidf : 0)*100,
						tfidf2 = (tfidfBank[genre2][word] ? tfidfBank[genre2][word].tfidf : 0)*100,
						genre1tf = (tfidfBank[genre1][word] ? tfidfBank[genre1][word].tf : 0),
						genre2tf = (tfidfBank[genre2][word] ? tfidfBank[genre2][word].tf : 0);
						if (tfidf1 > 0 || tfidf2 > 0){
							genreScores.push({
								word: word,
								tfidf1: tfidf1,
								tfidf2: tfidf2,
								color: (tfidf2 > tfidf1 ? colors[genre2].heavy : colors[genre1].heavy),
								song: d.song,
								artist: d.artist,
								tf: Math.max(genre1tf, genre2tf)
							});
						}
					if (tfidf1>tfidf2) bgcolor = colors[genre1].medium;
					else if (tfidf1<tfidf2) bgcolor = colors[genre2].medium
					else if (tfidf1 > 0) bgcolor = colors[genre1].medium
					htmlString += ' <span style="background-color: '+bgcolor+'">' + word + '</span> '
				}

				$('#tfidfchart').empty();

				var visualizationTfidf = d3plus.viz()
					.container("#tfidfchart")
					.data(genreScores)
					.order({
						"value": "tf",
						"sort": "asc"
					})
					.color(function(d){
						return d.color;
					})
					.legend(false)
					.type("scatter")    
					.id("word")
					.text(function(d){
						return d.word;
					})
					.tooltip(["word", "song", "artist"])
					.x({
						value: "tfidf2",
						label: genre2 + " tf-idf"
					})
					.y({
						value: "tfidf1",
						label: genre1 + " tf-idf"
					})
					.size(function(d){
						return (d.tf)
					})
					.height(360)
					.width(600)
					.draw();

				$('#text').html(htmlString)
				$('#tfidf-words').html("The most " + phrases[genre1+"1"] + ' words weighted by tf-idf for <span class="underline">' + d.song + "</span>")
				$('#tfidf-scores').html("tf-idf scores for " + '<span class="underline">' + d.song + '</span>, sized by tf')
			}

			var colors = {
				'Country': {
					'heavy': '#e6550d',
					'medium': '#fd8d3c',
					'light': '#fdbe85'
				},
				'Hip_Hop': {
					'heavy': '#3182bd',
					'medium': '#6baed6',
					'light': '#bdd7e7'
				},
				'Alt_Rock': {
					'heavy': '#31a354',
					'medium': '#74c476',
					'light': '#bae4b3'
				}
			};

			var phrases = {
				'Hip_Hop1': 'hip hop',
				'Alt_Rock1': 'alt rock',
				'Country1': 'country',
				'Hip_Hop2': 'hip hop songs',
				'Alt_Rock2': 'alt rock songs',
				'Country2': 'country songs' 
			};

			var colOrder = {
				'Hip_Hop': 3,
				'Alt_Rock': 4,
				'Country': 5
			}

			var table;

			var drawScatter = function(data_, genre1, genre2, selector){

				var filteredData = data_.filter(function(d){
					return (d.ranker_genre == genre2)
				}).sort(function(a,b){
					return b[genre1] - a[genre1];
				}).slice(1, 101);

				if (!table){
				    table = $('#table').DataTable( {
				        "scrollY":        "280px",
				        "scrollCollapse": false,
				        "paging":         false,
				        "data": filteredData,
				        "order": [[ colOrder[genre1], "desc" ]],
				        "columns": [
				            { "data": "ranker_genre" },
				            { "data": "artist" },
				            { "data": "song" },
				            { "data": "Hip_Hop"},
				            { "data": "Alt_Rock"},
				            { "data": "Country"},
				        ]
				    } );
				} else {
					table.search('').draw();
					table
						.clear()
						.rows
						.add(filteredData)
						.order([ colOrder[genre1], "desc" ])
						.draw();
				}

				var visualization = d3plus.viz()
					.container(selector)
					.data(filteredData)
					.color(function(d){
						return colors[d.ranker_genre].heavy
					})
					.type("scatter")    
					.id("songScore")
					.text(function(d){
						return d.song;
					})
					.tooltip(["album", "artist", "song", "year"])
					.x({
						value: genre2
					})
					.y({
						value: genre1
					})
					.size(10)
					.height(350)
					.width(600)
					.mouse({
						click: function(d){
							drillDown(d, genre1, genre2, selector);
						}
					})
					.draw()

				$(selector+"phrase")
					.text(
						(selector == "#scatterLeft" ? 'The most ' : "The top 100 ") + 
						phrases[genre1+"1"] + " " + 
						phrases[genre2+"2"]
					)
				$('#scatterRightphrase').text('The top 100 ' + phrases[genre1+"1"] + ' ' + phrases[genre2+"2"]);
			}

			var changeScatterOne = function(genre1, genre2){
			    $("#genre2left").val(genre1);
			    $("#genre1left").val(genre2);
				$('#submitScatterOne').click();
			}

			$('#fuckThaPolice').on('click', function(e){
				changeScatterOne('Alt_Rock', 'Hip_Hop');
				var fuckThaPolice = data.filter(function(d){return d.song == 'Fuck tha Police (Live)'})[0];
				drillDown(fuckThaPolice, 'Hip_Hop', 'Alt_Rock', '#scatterLeft')
			});

			$('#thugStory').on('click', function(e){
				changeScatterOne('Country', 'Hip_Hop');
				var thugStory = data.filter(function(d){return d.song == 'Thug Story' && d.artist == 'Taylor Swift'})[0];
				drillDown(thugStory, 'Hip_Hop', 'Country', '#scatterLeft')
			});

			$('#ultimasPalabras').on('click', function(e){
				changeScatterOne('Hip_Hop', 'Alt_Rock');
				var ultimasPalabras = data.filter(function(d){return d.song == 'Ultimas Palabras' && d.artist == 'Immortal_Technique'})[0];
				drillDown(ultimasPalabras, 'Alt_Rock', 'Hip_Hop', '#scatterLeft')
			});

			$('#newOrleans').on('click', function(e){
				changeScatterOne('Alt_Rock', 'Country');
				var newOrleans = data.filter(function(d){return d.song == 'New Orleans' && d.artist == 'Joan Jett and the Blackhearts'})[0];
				drillDown(newOrleans, 'Country', 'Alt_Rock', '#scatterLeft')
			});

			$('#blackMoon').on('click', function(e){
				changeScatterOne('Alt_Rock', 'Hip_Hop');
				var blackMoon = data.filter(function(d){return d.song == 'Black Moon' && d.artist == 'Deftones'})[0];
				drillDown(blackMoon, 'Hip_Hop', 'Alt_Rock', '#scatterLeft')
			});

			drawScatter(data, 'Alt_Rock', 'Hip_Hop', '#scatterLeft');

			$('#submitScatterOne').on('click', function(e){
				$('#scatterLeft').empty();
				var genre1 = $('#genre1left').find(":selected").text();
				var genre2 = $('#genre2left').find(":selected").text();
				drawScatter(data, genre1, genre2, '#scatterLeft');
			});

		});
	});
});
</script>
